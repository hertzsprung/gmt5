Package: gmt5
Version: 5.1.0
Revision: 1
Source: ftp://ftp.soest.hawaii.edu/gmt/gmt-%v-src.tar.bz2
Source-MD5: da741319c883a3dbaf27ec7eaf66c166
SourceDirectory: gmt-%v

Conflicts: gmt
BuildDepends: cmake, netcdf-c7, libpcre1, gdal (>= 1.10.1)
Depends: netcdf-c7-shlibs, %n-shlibs (= %v-%r), libpcre1-shlibs, gdal-shlibs (>= 1.10.1), gshhg (>= 2.2.4), dcw-gmt (>= 1.1.0)
Recommends: %n-doc
NoSetCPPFLAGS: true
NoSetLDFLAGS: true

# don't build xgrid to avoid x11 dependency.
# don't build mex (won't work unless matlab or octave is installed).

PatchScript: <<
  perl -pi -e 's|\@executable_path/\${_rpath}|%p/\${GMT_LIBDIR}|' cmake/modules/ConfigCMake.cmake
  perl -pi -e 's|\@executable_path/../lib|%p/\${GMT_LIBDIR}|' cmake/dist/CMakeLists.txt
<<
CompileScript: <<
  #!/bin/sh -ev
  mkdir build
  cd build
  cmake \
	-DCMAKE_C_FLAGS_RELEASE="-O3 -DNDEBUG -fstrict-aliasing" \
	-DCMAKE_INSTALL_PREFIX=%p \
	-DGMT_DOCDIR=%i/share/doc/gmt \
	-DNETCDF_ROOT=%p \
	-DGSHHG_ROOT=%p \
	-DDCW_ROOT=%p \
	-DFFTW3_ROOT=off \
	-DGDAL_ROOT=off \
	-DPCRE_ROOT=off \
	-DFLOCK=on \
	-DGMT_INSTALL_NAME_SUFFIX=5 \
	-DGMT_SOURCE_CODE_CONTROL_VERSION_STRING=%v-%r \
	-DLICENSE_RESTRICTED=LGPL \
	-DCMAKE_OSX_DEPLOYMENT_TARGET="" \
        -DCMAKE_OSX_SYSROOT=/ \
	..
  make
<<
InstallScript: <<
  #!/bin/sh -ev
  cd build
  cmake -DCMAKE_INSTALL_PREFIX=%i -P cmake_install.cmake
<<
SplitOff: <<
  Package: %N-doc
  Conflicts: gmt-doc
  BuildDependsOnly: True
  Files: share/doc/gmt
  DocFiles: LICENSE.TXT
<<
SplitOff2: <<
  Package: %N-shlibs
  Conflicts: gmt-shlibs
  Files: lib/*.5.*dylib lib/gmt5
  Shlibs: <<
    %p/lib/libgmt.5.dylib 5.0.0 %n (>= 5.1.0-1)
    %p/lib/libpsl.5.dylib 5.0.0 %n (>= 5.1.0-1)
    %p/lib/gmt5/plugins/supplements.so 5.0.0 %n (>= 5.1.0-1)
  <<
  DocFiles: ChangeLog LICENSE.TXT README src/README.TRIANGLE src/TRIANGLE.HOWTO
<<
SplitOff3: <<
  Package: %N-dev
  Conflicts: gmt-dev
  BuildDependsOnly: True
  Files: include lib/*.dylib
  DocFiles: ChangeLog LICENSE.TXT README* src/README.TRIANGLE src/TRIANGLE.HOWTO
<<
Description: Generic Mapping Tools
DescDetail: <<
 GMT is an open source collection of ~60 tools for manipulating
 geographic and Cartesian data sets (including filtering, trend
 fitting, gridding, projecting, etc.) and producing Encapsulated
 PostScript File (EPS) illustrations ranging from simple x-y plots
 via contour maps to artificially illuminated surfaces and 3-D
 perspective views. GMT supports ~30 map projections and transformations
 and comes with support data such as coastlines, rivers, and political
 boundaries.
<<
DescPort: <<
 Removed xgrid supplementary package so X11 is not required.
 Removed mex support so that neither matlab or octave are required.
<<
License: GPL, Restrictive/Distributable
DocFiles: ChangeLog LICENSE.TXT README src/README.TRIANGLE src/TRIANGLE.HOWTO
Maintainer: Kurt Schwehr <goatbar@users.sourceforge.net>
Homepage: http://gmt.soest.hawaii.edu/
