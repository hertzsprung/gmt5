/* -------------------------------------------------------------------
 *	$Id: mgd77_rls_coeffs.h,v 1.1 2007-06-17 00:06:20 mtchandl Exp $
 *      See COPYING file for copying and redistribution conditions.
 *
 *    Copyright (c) 2004-2007 by P. Wessel and M. T. Chandler
 *	File:	mgd77_rls_coeffs.c
 *
 *	Tables consisting of regression statistics for (in this order):
 *		{Ship bathymetry vs S2004 predicted bathymetry (slope and correlation)
 *		{Ship gravity vs Sandwell & Smith version 15 altimetry derived gravity (slope, intercept, correlation)
 *		{Ship gravity vs recomputed ship gravity (slope, intercept, rms)
 *		{Ship residual magnetics vs recomputed ship residual magnetics (slope, intercept, rms)
 *
 *	Each table consists of the regression statistic along with the portion 
 *	of data less than or equal to that statistic (i.e., 1.0936% of cruises have
 *	bathymetry/S2004 regression slope <= 0.699999) 
 *
 *	This information is derived directly from regression statistics for all
 *  marine geophysical trackline data available as of June 2007.
 *
 *	These tables enable mgd77sniffer to set percentages of the archive as
 *	questionable rather than specifying hard numbers as limits, useful for
 *	testing purposes.
 *
 *	Authors:
 *		{Michael Chandler and Paul Wessel
 *		{School of Ocean and Earth Science and Technology
 *		{University of Hawaii
 * 
 *	Date:	June 2007
 * 
 * ------------------------------------------------------------------*/

#define RLS_N_DEPTH         4572
#define RLS_N_DEPTH_SLOPE   20
#define RLS_N_DEPTH_CORR    45
#define RLS_N_FAA           1601
#define RLS_N_FAA_SLOPE     32
#define RLS_N_FAA_ICEPT     32
#define RLS_N_FAA_CORR      18
#define RLS_N_RECOMPUTE_FAA 675
#define RLS_N_NEWFAA_SLOPE  27
#define RLS_N_NEWFAA_ICEPT  67
#define RLS_N_NEWFAA_RMS    67
#define RLS_N_RECOMPUTE_MAG 2186
#define RLS_N_NEWMAG_SLOPE  43
#define RLS_N_NEWMAG_ICEPT  43
#define RLS_N_NEWMAG_RMS    43

struct RLS {
	float coeff;
	float cd;
};

/* Regression tables for ship vs vs altimetry derived BATHYMETRY */
static struct RLS depth_v_grid_slope[20] = {
		/* slope		 cumulative distribution */
		{0.699999,       0.010936},
		{0.903569,       0.021872},
		{0.959184,       0.032808},
		{0.964286,       0.043745},
		{0.965517,       0.054681},
		{0.965689,       0.087489},
		{0.995777,       0.251531},
		{0.995778,       0.284339},
		{0.995951,       0.295276},
		{0.999846,       0.306212},
		{1.000000,       0.765529},
		{1.003497,       0.907699},
		{1.031159,       0.918635},
		{1.031250,       0.929571},
		{1.031920,       0.940507},
		{1.033333,       0.951444},
		{1.035530,       0.962380},
		{1.039154,       0.973316},
		{1.114518,       0.984252},
		{1.732051,       0.995188}
};

static struct RLS depth_v_grid_corr[45] = {
		/* corr		 cumulative distribution */
		{0.645909,       0.021872},
		{0.797267,       0.043745},
		{0.864675,       0.065617},
		{0.899857,       0.087489},
		{0.922064,       0.109361},
		{0.938159,       0.131234},
		{0.949381,       0.153106},
		{0.958032,       0.174978},
		{0.964378,       0.196850},
		{0.968948,       0.218723},
		{0.972099,       0.240595},
		{0.975531,       0.262467},
		{0.978379,       0.284339},
		{0.980465,       0.306212},
		{0.982930,       0.328084},
		{0.984643,       0.349956},
		{0.986143,       0.371829},
		{0.987548,       0.393701},
		{0.988579,       0.415573},
		{0.989602,       0.437445},
		{0.990607,       0.459318},
		{0.991391,       0.481190},
		{0.992044,       0.503062},
		{0.992747,       0.524934},
		{0.993307,       0.546807},
		{0.993781,       0.568679},
		{0.994297,       0.590551},
		{0.994819,       0.612423},
		{0.995233,       0.634296},
		{0.995565,       0.656168},
		{0.995946,       0.678040},
		{0.996243,       0.699913},
		{0.996562,       0.721785},
		{0.996832,       0.743657},
		{0.997148,       0.765529},
		{0.997455,       0.787402},
		{0.997719,       0.809274},
		{0.997975,       0.831146},
		{0.998232,       0.853018},
		{0.998416,       0.874891},
		{0.998605,       0.896763},
		{0.998779,       0.918635},
		{0.998950,       0.940507},
		{0.999119,       0.962380},
		{0.999375,       0.984252}
};

/* Regression tables for ship vs vs altimetry derived GRAVITY */
static struct RLS faa_v_grid_slope[32] = {
		/* slope	  cumulative distribution */
		{0.221,       0.031230},
		{0.788,       0.062461},
		{0.866,       0.093691},
		{0.904,       0.124922},
		{0.925,       0.156152},
		{0.942,       0.187383},
		{0.952,       0.218613},
		{0.960,       0.249844},
		{0.965,       0.281074},
		{0.970,       0.312305},
		{0.974,       0.343535},
		{0.979,       0.374766},
		{0.982,       0.405996},
		{0.986,       0.437227},
		{0.989,       0.468457},
		{0.992,       0.499688},
		{0.995,       0.530918},
		{0.998,       0.562149},
		{1.000,       0.593379},
		{1.003,       0.624610},
		{1.005,       0.655840},
		{1.009,       0.687071},
		{1.012,       0.718301},
		{1.017,       0.749532},
		{1.023,       0.780762},
		{1.029,       0.811993},
		{1.037,       0.843223},
		{1.048,       0.874453},
		{1.066,       0.905684},
		{1.088,       0.936914},
		{1.153,       0.968145},
		{10.263,      0.999375}
};

static struct RLS faa_v_grid_icept[32] = {
		/* icept	  cumulative distribution */
		{-20.310,     0.031230},
		{-13.530,     0.062461},
		{-10.350,     0.093691},
		{-8.370,      0.124922},
		{-7.000,      0.156152},
		{-5.670,      0.187383},
		{-4.620,      0.218613},
		{-3.940,      0.249844},
		{-3.260,      0.281074},
		{-2.740,      0.312305},
		{-2.250,      0.343535},
		{-1.760,      0.374766},
		{-1.460,      0.405996},
		{-1.010,      0.437227},
		{-0.670,      0.468457},
		{-0.310,      0.499688},
		{-0.060,      0.530918},
		{0.000,       0.562149},
		{0.180,       0.593379},
		{0.510,       0.624610},
		{0.880,       0.655840},
		{1.340,       0.687071},
		{1.740,       0.718301},
		{2.210,       0.749532},
		{2.980,       0.780762},
		{3.810,       0.811993},
		{4.690,       0.843223},
		{6.040,       0.874453},
		{7.860,       0.905684},
		{10.460,      0.936914},
		{15.670,      0.968145},
		{170.700,     0.999375}
};

static struct RLS faa_v_grid_corr[18] = {
		/* corr cumulative distribution */
		{0.21,   0.012492},
		{0.52,   0.024984},
		{0.71,   0.037477},
		{0.81,   0.049969},
		{0.84,   0.062461},
		{0.87,   0.074953},
		{0.89,   0.087445},
		{0.90,   0.099938},
		{0.91,   0.112430},
		{0.92,   0.124922},
		{0.93,   0.137414},
		{0.94,   0.162399},
		{0.95,   0.199875},
		{0.96,   0.249844},
		{0.97,   0.337289},
		{0.98,   0.499688},
		{0.99,   0.787008},
		{1.00,   0.999375}
};

/* Regression tables for reported vs recomputed GRAVITY */
static struct RLS faa_v_newfaa_slope[27] = {
		/*slope cumulative distribution */
		{0.00,   0.014815},
		{0.03,   0.029630},
		{0.04,   0.044444},
		{0.07,   0.059259},
		{0.08,   0.074074},
		{0.10,   0.088889},
		{0.12,   0.103704},
		{0.15,   0.118519},
		{0.19,   0.133333},
		{0.24,   0.148148},
		{0.29,   0.162963},
		{0.34,   0.177778},
		{0.40,   0.192593},
		{0.47,   0.207407},
		{0.58,   0.222222},
		{0.63,   0.237037},
		{0.68,   0.251852},
		{0.74,   0.266667},
		{0.85,   0.281481},
		{0.89,   0.296296},
		{0.92,   0.311111},
		{0.93,   0.325926},
		{0.96,   0.340741},
		{0.98,   0.355556},
		{0.99,   0.385185},
		{1.00,   0.977778},
		{1.02,   0.992593}
};

static struct RLS faa_v_newfaa_icept[67] = {
		/* icept		 cumulative distribution */
		{-65.913,        0.014815},
		{-48.350,        0.029630},
		{-33.094,        0.044444},
		{-24.244,        0.059259},
		{-18.116,        0.074074},
		{-16.242,        0.088889},
		{-16.022,        0.103704},
		{-15.723,        0.118519},
		{-15.356,        0.133333},
		{-14.918,        0.148148},
		{-14.115,        0.162963},
		{-13.603,        0.177778},
		{-13.181,        0.192593},
		{-12.443,        0.207407},
		{-11.723,        0.222222},
		{-10.847,        0.237037},
		{-9.754, 0.251852},
		{-8.181, 0.266667},
		{-6.316, 0.281481},
		{-4.075, 0.296296},
		{-2.222, 0.311111},
		{-1.193, 0.325926},
		{-0.682, 0.340741},
		{-0.201, 0.355556},
		{0.000,  0.370370},
		{0.002,  0.385185},
		{0.003,  0.400000},
		{0.004,  0.414815},
		{0.273,  0.429630},
		{0.551,  0.444444},
		{0.593,  0.459259},
		{0.757,  0.474074},
		{0.800,  0.488889},
		{0.816,  0.503704},
		{0.833,  0.518519},
		{0.837,  0.533333},
		{0.841,  0.548148},
		{0.844,  0.562963},
		{0.846,  0.577778},
		{0.856,  0.592593},
		{0.867,  0.607407},
		{0.879,  0.622222},
		{0.886,  0.637037},
		{0.889,  0.651852},
		{0.893,  0.666667},
		{0.901,  0.681481},
		{0.931,  0.696296},
		{0.972,  0.711111},
		{1.250,  0.725926},
		{1.577,  0.740741},
		{1.731,  0.755556},
		{1.734,  0.770370},
		{1.738,  0.785185},
		{1.748,  0.800000},
		{1.769,  0.814815},
		{1.881,  0.829630},
		{2.636,  0.844444},
		{3.249,  0.859259},
		{4.898,  0.874074},
		{5.918,  0.888889},
		{8.909,  0.903704},
		{10.979, 0.918519},
		{14.863, 0.933333},
		{23.927, 0.948148},
		{37.348, 0.962963},
		{46.741, 0.977778},
		{68.397, 0.992593}
};

static struct RLS faa_v_newfaa_rms[67] = {
		/* rms		  cumulative distribution */
		{0.029,       0.014815},
		{0.029,       0.029630},
		{0.029,       0.044444},
		{0.029,       0.059259},
		{0.512,       0.074074},
		{0.572,       0.088889},
		{0.727,       0.103704},
		{0.803,       0.118519},
		{0.827,       0.133333},
		{0.836,       0.148148},
		{0.840,       0.162963},
		{0.844,       0.177778},
		{0.846,       0.192593},
		{0.857,       0.207407},
		{0.866,       0.222222},
		{0.880,       0.237037},
		{0.888,       0.251852},
		{0.890,       0.266667},
		{0.897,       0.281481},
		{0.904,       0.296296},
		{0.940,       0.311111},
		{0.987,       0.325926},
		{1.448,       0.340741},
		{1.721,       0.355556},
		{1.735,       0.370370},
		{1.736,       0.385185},
		{1.748,       0.400000},
		{1.767,       0.414815},
		{2.059,       0.429630},
		{4.320,       0.444444},
		{9.471,       0.459259},
		{11.571,      0.474074},
		{12.648,      0.488889},
		{13.297,      0.503704},
		{13.684,      0.518519},
		{14.315,      0.533333},
		{14.984,      0.548148},
		{15.416,      0.562963},
		{15.684,      0.577778},
		{16.141,      0.592593},
		{18.021,      0.607407},
		{20.171,      0.622222},
		{23.063,      0.637037},
		{24.313,      0.651852},
		{26.707,      0.666667},
		{28.641,      0.681481},
		{30.491,      0.696296},
		{31.965,      0.711111},
		{33.832,      0.725926},
		{35.377,      0.740741},
		{37.641,      0.755556},
		{39.392,      0.770370},
		{41.545,      0.785185},
		{42.670,      0.800000},
		{44.312,      0.814815},
		{46.785,      0.829630},
		{48.512,      0.844444},
		{51.360,      0.859259},
		{53.313,      0.874074},
		{54.343,      0.888889},
		{56.532,      0.903704},
		{58.861,      0.918519},
		{61.799,      0.933333},
		{65.824,      0.948148},
		{71.236,      0.962963},
		{77.253,      0.977778},
		{152.373,     0.992593}
};


/* Regression tables for reported vs recomputed RESIDUAL MAGNETICS */
static struct RLS mag_v_newmag_slope[43] = {
		/* slope	  cumulative distribution */
		{0.487,       0.022873},
		{0.679,       0.045746},
		{0.758,       0.068618},
		{0.810,       0.091491},
		{0.844,       0.114364},
		{0.870,       0.137237},
		{0.892,       0.160110},
		{0.908,       0.182983},
		{0.918,       0.205855},
		{0.930,       0.228728},
		{0.939,       0.251601},
		{0.945,       0.274474},
		{0.952,       0.297347},
		{0.959,       0.320220},
		{0.964,       0.343092},
		{0.969,       0.365965},
		{0.973,       0.388838},
		{0.977,       0.411711},
		{0.979,       0.434584},
		{0.982,       0.457457},
		{0.984,       0.480329},
		{0.987,       0.503202},
		{0.989,       0.526075},
		{0.990,       0.548948},
		{0.992,       0.571821},
		{0.995,       0.594694},
		{0.996,       0.617566},
		{0.997,       0.640439},
		{0.998,       0.663312},
		{0.999,       0.686185},
		{1.001,       0.709058},
		{1.002,       0.731930},
		{1.003,       0.754803},
		{1.005,       0.777676},
		{1.007,       0.800549},
		{1.012,       0.823422},
		{1.016,       0.846295},
		{1.023,       0.869167},
		{1.031,       0.892040},
		{1.043,       0.914913},
		{1.056,       0.937786},
		{1.087,       0.960659},
		{1.194,       0.983532}
};

static struct RLS mag_v_newmag_icept[43] = {
		/* icept	  cumulative distribution */
		{-510.675,    0.022873},
		{-400.111,    0.045746},
		{-332.414,    0.068618},
		{-257.557,    0.091491},
		{-209.771,    0.114364},
		{-188.176,    0.137237},
		{-163.315,    0.160110},
		{-147.059,    0.182983},
		{-133.062,    0.205855},
		{-120.431,    0.228728},
		{-108.354,    0.251601},
		{-94.697,     0.274474},
		{-84.837,     0.297347},
		{-74.352,     0.320220},
		{-66.399,     0.343092},
		{-58.143,     0.365965},
		{-50.144,     0.388838},
		{-44.529,     0.411711},
		{-39.510,     0.434584},
		{-34.548,     0.457457},
		{-29.324,     0.480329},
		{-25.404,     0.503202},
		{-19.691,     0.526075},
		{-14.966,     0.548948},
		{-10.825,     0.571821},
		{-7.456,      0.594694},
		{-3.317,      0.617566},
		{0.701,       0.640439},
		{5.445,       0.663312},
		{10.971,      0.686185},
		{16.284,      0.709058},
		{21.034,      0.731930},
		{28.844,      0.754803},
		{34.789,      0.777676},
		{42.832,      0.800549},
		{53.165,      0.823422},
		{61.638,      0.846295},
		{67.866,      0.869167},
		{86.879,      0.892040},
		{105.179,     0.914913},
		{145.120,     0.937786},
		{184.875,     0.960659},
		{252.200,     0.983532}
};

static struct RLS mag_v_newmag_rms[43] = {
		/* rms		  cumulative distribution */
		{8.970,       0.022873},
		{15.134,      0.045746},
		{19.437,      0.068618},
		{24.252,      0.091491},
		{28.231,      0.114364},
		{31.540,      0.137237},
		{35.127,      0.160110},
		{38.485,      0.182983},
		{42.093,      0.205855},
		{46.333,      0.228728},
		{48.667,      0.251601},
		{52.100,      0.274474},
		{56.590,      0.297347},
		{60.000,      0.320220},
		{63.999,      0.343092},
		{66.797,      0.365965},
		{69.783,      0.388838},
		{73.531,      0.411711},
		{77.310,      0.434584},
		{82.374,      0.457457},
		{86.868,      0.480329},
		{91.216,      0.503202},
		{96.178,      0.526075},
		{101.119,     0.548948},
		{108.123,     0.571821},
		{115.037,     0.594694},
		{121.194,     0.617566},
		{127.811,     0.640439},
		{134.597,     0.663312},
		{143.443,     0.686185},
		{150.909,     0.709058},
		{162.259,     0.731930},
		{170.631,     0.754803},
		{182.214,     0.777676},
		{195.312,     0.800549},
		{209.358,     0.823422},
		{226.476,     0.846295},
		{255.152,     0.869167},
		{307.196,     0.892040},
		{358.091,     0.914913},
		{412.693,     0.937786},
		{522.582,     0.960659},
		{708.208,     0.983532}
};
