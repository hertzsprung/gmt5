#include "common_options.txt"
.TH PSLEGEND 1 MANDATE GMT_STRING "Generic Mapping Tools"
#define CLEARENCE_SI 0.15\fBc\fP/0.15\fBc\fP
#define CLEARENCE_US 0.05\fBi\fP/0.05\fBi\fP
.SH NAME
pslegend \- To plot a map legend
.SH SYNOPSIS
\fBpslegend\fP \fItextfile\fP OPT(D)[\fBx\fP]\fIlon\fP/\fIlat\fP/\fIwidth\fP/\fIheight\fP/\fIjust\fP GMT_J_OPT 
GMT_Rgeo_OPT [ GMT_B_OPT ] [ OPT(C)\fIdx\fP/\fIdy\fP ] [ OPT(F) ] 
[ OPT(G)\fIfill\fP ] [ GMT_K_OPT ] [ OPT(L)\fIspacing\fP ] [ GMT_O_OPT ] [ GMT_P_OPT ] 
[ OPT(S)[\fIscript\fP] ] [ GMT_U_OPT ] [ GMT_V_OPT ] [ GMT_X_OPT ] [ GMT_c_OPT ]
[ GMT_Y_OPT ]
.SH DESCRIPTION
\fBpslegend\fP will make legends that can be overlaid on maps.  It reads specific
legend-related information from an input file [or stdin].  Because all the elements
of the legend can already be created with other tools (\fBpsxy\fP, \fBpstext\fP) we
use those tools by creating a batch job of commands that are executed to make the final
\fIPostScript\fP overlay.  Because of this process, the option exists to just output the script which
can then be fine-tuned manually.  Unless otherwise noted, annotations will be made using the
annotation font and size in effect.
.TP
\fItextfile\fP
This file contains instruction for the layout of items in the legend.  Each legend item is described by
a unique record.  All records begin with a unique character that is common to all records of the same
kind.  The order of the legend items is implied by the order of the records.  Ten different record types
are recognized, and the syntax for each of these records are presented below:
.sp
.RS
\fB#\fP \fIcomment\fP
Records starting with # and blank lines are skipped.
.TP
\fBB\fP \fIcptname offset height\fP [ \fIoptional arguments\fP ]
The \fBB\fP record will plot a horizontal color bar, \fBpsscale\fP-style in the middle, starting at \fIoffset\fP from
the left edge, and of the given \fIheight\fP.  You may add any additional \fPpsscale\fP options from the list:
OPT(A) OPT(B) OPT(E) OPT(I) OPT(L) OPT(M) OPT(N) OPT(S) and OPT(Z).
.TP
\fBC\fP \fItextcolor\fP
The \fBC\fP record specifies the color with which the remaining text is to be printed.
\fItextcolor\fP can be in the form \fIr/g/b\fP, \fIc/m/y/k\fP, or a named color.
.TP
\fBD\fP \fIoffset pen\fP
The \fBD\fP record results in a horizontal line with specified \fIpen\fP across the legend with one quarter of
the line spacing left blank above and below the line.  Two gaps of \fIoffset\fP units are left blank between
the horizontal line and the left and right frame sides.
(See SPECIFYING PENS below).
.TP
\fBG\fP \fIgap\fP
The \fBG\fP record specifies a vertical gap of the given length. 
In addition to the standard units (\fBi\fP, \fBc\fP, \fBp\fP) you may use \fBl\fP for lines.
.TP
\fBH\fP \fIfontsize\fP|\fB-\fP \fIfont\fP|\fB-\fP header\fP
The \fBH\fP record plots a centered text string using the specified font parameters.
Use \fB-\fP to default to \fBHEADER_FONT_SIZE\fP and \fBHEADER_FONT\fP.
.TP
\fBI\fP \fIimagefile width justification\fP
Place an EPS or Sun raster image in the legend justified relative to the current point.  The
image \fIwidth\fP determines the size of the image on the page.
.TP
\fBL\fP \fIfontsize\fP|\fB-\fP \fIfont\fP|\fB-\fP justification label\fP
The \fBL\fP record plots a (L)eft, (C)entered, or (R)ight-justified text string within a column using
the specified font parameters.
Use \fB-\fP to default to \fBLABEL_FONT_SIZE\fP and \fBLABEL_FONT\fP.
.TP
\fBM\fP \fIslon\fP|\fB-\fP \fIslat length\fP \fBf\fP|\fBp\fP [ OPT(R)\fIw/e/s/n\fP OPT(J)\fIparam\fP ]
Place a map scale in the legend.  Specify \fIslon slat\fP, the point on the map where the scale applies (\fIslon\fP
is only meaningful for certain oblique projections.  If not needed, you must specify \fB-\fP instead),
\fIlength\fP, the length of the scale in km (append \fBm\fP or \fBn\fP for miles or nautical miles), and
\fBf\fP or \fBp\fP for fancy or plain scale.  If the OPT(R) OPT(J) supplied to \fBpslegend\fP is different than the
projection needed for the scale, supply the optional OPT(R) OPT(J) settings as well.  
Append \fB+l\fP to the \fIlength\fP to
select the default label which equals the distance unit (km, miles, nautical miles) and is justified on top of the scale [t].
Change this by giving your own label (append \fB+l\fP\fIlabel\fP).  Change label justification with \fB+j\fP\fIjustification\fP
(choose among l(eft), r(ight), t(op), and b(ottom)).  Apply \fB+u\fP to append the unit to all distance annotations along the scale. 
If you want to place a rectangle behind the scale, specify suitable \fB+p\fP\fIpen\fP and/or \fB+f\fP\fIfill\fP parameters.
All these \fP+\fP\fImodifiers\fP are appended to \fIlength\fP to make a single string.
(See SPECIFYING PENS and SPECIFYING FILL below).
.TP
\fBN\fP \fIncolumns\fP
Change the number of columns in the legend [1]. This only affects the printing of symbols (\fBS\fP) and 
labels (\fBL\fP).
.TP
\fBS\fP \fIdx1 symbol size fill pen\fP [ \fIdx2 text\fP ]
Plots the selected symbol with specified size, fill, and outline (see \fBpsxy\fP).
The symbol is centered at \fIdx1\fP from the left margin of the column,
with the optional explanatory \fItext\fP starting \fIdx2\fP from the margin, printed with fontsize
\fBANNOT_FONT_SIZE_PRIMARY\fP and font \fBANNOT_FONT_PRIMARY\fP.
Use \fB-\fP if no \fIfill\fP or outline (\fIpen\fP) is required.
When plotting just a symbol, without text, \fIdx2\fP and \fItext\fP can be omitted.
Two \fBpsxy\fP symbols require special attention: front (f) and vector (v).  You must prepend
the length of the desired item to the rest of the symbol argument; this will be used internally to set the
correct fault or vector length and will be stripped before passing the arguments to \fBpsxy\fP.
.TP
\fBT\fP \fIparagraph-text\fP
One or more of these \fBT\fP records with \fIparagraph-text\fP printed with fontsize
\fBANNOT_FONT_SIZE_PRIMARY\fP and font \fBANNOT_FONT_PRIMARY\fP (aligned and wrapped).
To specify special positioning and typesetting arrangements, or to enter a paragraph break, use the
optional \fB>\fP record.
.TP
\fBV\fP \fIoffset pen\fP
The \fBV\fP record draws a vertical line between columns (if more than one) using the selected \fIpen\fP
(See SPECIFYING PENS below).
\fIoffset\fP is analogous to the offset for the \fBD\fP records but in the vertical direction.
.TP
\fB>\fP \fIparagraph-mode-header-for-pstext\fP
Start a new text paragraph by specifying all the parameters needed (see \fBpstext \-m\fP description).  Note that
\fBpslegend\fP knows what all those values should be, so normally you can leave the entire record (after >) blank or
leave it out all together.
If you need to set at least one of the parameters directly, you must specify all and set the ones you want to leave
at their default value to \fB-\fP.
.RE
.br
.TP
OPT(D)
Positions the legend and specifies its size.  The \fIjust\fP is a 2-char justification string (see \fBpstext\fP)
that relates the given position to a point on the rectangular legend box.  If you want to specify the position
in map plot units (i.e., inches or cm), use OPT(Dx).
#include "explain_-J_short.txt"
#include "explain_-R.txt"
.SH OPTIONS
No space between the option flag and the associated arguments.
#include "explain_-B_short.txt"
.TP
OPT(C)
Sets the clearance between the legend frame and the internal items [CLEARENCE_SI (or CLEARENCE_US)].
.TP
OPT(F)
Draws a border around the legend using \fBFRAME_PEN\fP.
.TP
OPT(G)
Select fill shade, color or pattern of the legend box [Default is no fill].
(See SPECIFYING FILL below).
#include "explain_-K.txt"
.TP
OPT(L)
Sets the linespacing factor in units of the current annotation font size [1.1].
#include "explain_-O.txt"
#include "explain_-P.txt"
.TP
OPT(S)
Instead of writing the \fIPostScript\fP plot [Default], output the \fBGMT\fP script used to make the legend
to standard output, or optionally to the file \fIscript\fP.
#include "explain_-U.txt"
#include "explain_-V.txt"
#include "explain_-XY.txt"
#include "explain_-c.txt"
#include "explain_pen.txt"
#include "explain_fill.txt"
#include "explain_color.txt"
.SH EXAMPLES
To add an example of a legend to a Mercator plot (map.ps) with the given specifications, use
.br
.sp
\fBpslegend\fP OPT(R)-10/10/-10/10 OPT(JM)6i OPT(G)azure1 OPT(Dx)0.5i/0.5i/5i/3.3i/BL
OPT(C)0.1i/0.1i OPT(L)1.2 OPT(F) OPT(B)5f1 << EOF >> map.ps
.br
\# Legend test for pslegend
.br
\# G is vertical gap, V is vertical line, N sets # of columns, D draws horizontal line.
.br
\# H is header, L is label, S is symbol, T is paragraph text, M is map scale.
.br
\#
.br
G -0.1i
.br
H 24 Times-Roman My Map Legend
.br
D 0.2i 1p
.br
N 2
.br
V 0 1p
.br
S 0.1i c 0.15i p300/12 0.25p 0.3i This circle is hachured
.br
S 0.1i e 0.15i 255/255/0 0.25p 0.3i This ellipse is yellow
.br
S 0.1i w 0.15i 0/255/0 0.25p 0.3i This wedge is green
.br
S 0.1i f 0.25i/-1/0.075ilb 0/0/255 0.25p 0.3i This is a fault
.br
S 0.1i - 0.15i - 0.25tap 0.3i A contour
.br
S 0.1i v 0.25i/0.02i/0.06i/0.05i 255/0/255 0.25p 0.3i This is a vector
.br
S 0.1i i 0.15i 0/255/255 0.25p 0.3i This triangle is boring
.br
V 0 1p
.br
D 0.2i 1p
.br
N 1
.br
M 5 5 600+u f
.br
G 0.05i
.br
I SOEST_logo.ras 3i CT
.br
G 0.05i
.br
B colors.cpt 0.2i 0.2i
.br
G 0.05i
L 9 4 R Smith et al., @%5%J. Geophys. Res., 99@%%, 2000
.br
G 0.1i
.br
T Let us just try some simple text that can go on a few lines.
.br
T There is no easy way to predetermine how many lines will be required,
.br
T so we may have to adjust the box height to get the right size box.
.br
EOF
.br
.SH WINDOWS REMARKS
Note that under Windows, the percent sign (%) is a variable indicator (like $ under Unix).
To indicate a plain percentage sign in a batch script you need to repeat it (%%);
hence the font switching mechanism (@%\fIfont\fP% and @%%) may require twice the
number of percent signs.  This only applies to text inside a script or that otherwise
is processed by DOS.  Data files that are opened and read by \fBpslegend\fP do not need such duplication.
.SH "SEE ALSO"
.IR GMT (1),
.IR gmtcolors (5),
.IR gmtdefaults (1),
.IR psbasemap (1),
.IR pstext (1),
.IR psxy (1)
