#include "common_options.txt"
.TH GRDVOLUME 1 MANDATE GMT_STRING "Generic Mapping Tools"
.SH NAME
grdvolume \- Calculate grid volume and area constrained by a contour
.SH SYNOPSIS
BD(grdvolume) IT(grdfile) [ OPT(C)IT(cval) or OPT(C)IT(low/high/delta) ] 
[ OPT(L)IT(base) ] [ GMT_Rgeo_OPT ] [ OPT(S)[IT(unit)] ] [ OPT(T)[BD(c)|BD(h)] ] [ GMT_V_OPT ] 
[ OPT(Z)IT(fact)[/IT(shift)] ] [ GMT_fi_OPT ]
.SH DESCRIPTION
BD(grdvolume) reads a 2-D binary grid file and calculates the volume contained
between the surface and the plane specified by the given contour (or zero if not given)
and reports the area, volume, and maximum mean height (volume/area).
Alternatively, specify a range of contours to be tried and BD(grdvolume) will determine
the volume and area inside the contour for all contour values.  Using OPT(T), the contour
that produced the maximum mean height (or maximum curvature of heights vs contour value)
is reported as well.  This feature may be used with
BD(grdfilter) in designing an Optimal Robust Separator [IT(Wessel), 1998].
#include "explain_commonitems.txt"
.SH REQUIRED ARGUMENTS
.TP
IT(grdfile)
The name of the input 2-D binary grid file.
(See GRID FILE FORMAT below.)
.SH OPTIONAL ARGUMENTS
.TP
OPT(C)IT(cval) or OPT(C)IT(low/high/delta)
find area, volume and mean height (volume/area) inside the IT(cval) contour.  Alternatively, search using
all contours from IT(low) to IT(high) in steps of IT(delta).  [Default returns
area, volume and mean height of the entire grid].  The area is measured in the plane of the contour.
.TP
OPT(L)IT(base)
Also add in the volume from the level of the contour down to IT(base) [Default base is contour].
.TP
OPT(S)[IT(unit)]
Convert degrees to Flat Earth distances, append a unit from GMT_DIST_UNIT2 [Default is Cartesian].
.TP
OPT(T)[BD(c)|BD(h)]
Determine the single contour that maximized the average height (= volume/area).
Select OPT(Tc) to use the maximum curvature of heights versus contour value rather than
the contour with the maximum height to pick the best contour value (requires OPT(C)).
#include "explain_-R.txt"
#include "explain_-V.txt"
.TP
OPT(Z)IT(fact)[/IT(shift)]
Optionally subtract IT(shift) before scaling data by IT(fact). [Default is no scaling].
(Numbers in OPT(C), OPT(L) refer to values after this scaling has occurred).
#include "explain_-f.txt"
#include "explain_help.txt"
#include "explain_grd_input.txt"
.SH EXAMPLES
To determine the volume in km^3 under the surface hawaii_topo.nc (height in km), use
.br
.sp
grdvolume hawaii_topo.nc -Sk
.br
.sp
To find the volume between the surface peaks.nc and the contour z = 250, use
.br
.sp
grdvolume peaks.nc -Sk -C250
.br
.sp
To search for the contour, between 100 and 300 in steps of 10, that maximizes the ratio of volume
to surface area for the file peaks.nc, use
.br
.sp
grdvolume peaks.nc -Sk -C100/300/10 -Th > results.d
.br
.sp
To see the areas and volumes for all the contours in the previous example, use
.br
.sp
grdvolume peaks.nc -Sk -C100/300/10 > results.d
.SH "NOTES"
BD(grdvolume) distinguishes between gridline and pixel-registered grids. In both cases the area and
volume are computed up to the grid boundaries. That means that in the first case the grid cells on
the boundary only contribute half their area (and volume), whereas in the second case all grid cells
are fully used. The exception is when the OPT(C) flag is used: since contours do not extend beyond
the outermost grid point, both grid types are treated the same. That means the outer rim in pixel
oriented grids is ignored when using the OPT(C) flag.
.SH "SEE ALSO"
.IR gmt (1),
.IR grdfilter (1)
.SH REFERENCES
Wessel, P., 1998, An empirical method for optimal robust regional-residual separation of geophysical data,
IT(Math. Geol.), BD(30)(4), 391\-408.
