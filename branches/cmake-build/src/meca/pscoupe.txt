#include "common_options.txt"
.TH PSCOUPE 1 MANDATE GMT_STRING "Generic Mapping Tools [meca supplement]"   
.SH NAME
pscoupe \- Plot cross-sections of focal mechanisms
.SH SYNOPSIS
BD(pscoupe) [ IT(files) ] GMT_J_OPT GMT_Rgeo_OPT
OPT(A)IT(parameters) [ GMT_B_OPT ]  [ OPT(E)IT(fill) ]
[ OPT(G)IT(fill) ]
[ GMT_K_OPT ] [ OPT(L)IT([pen]) ] [ OPT(M) ] [ OPT(N) ] [ GMT_O_OPT ] 
[ GMT_P_OPT ] [ OPT(S)IT(<symbol><scale>)[/BD(d)] ]
[ OPT(s)IT(<format><size>)[/BD(d)] ] [ OPT(T)IT(n) ] [ GMT_U_OPT ]
[ GMT_V_OPT ] [ OPT(W)IT(pen) ] [ GMT_X_OPT ]
[ GMT_Y_OPT ] [ OPT(Z)IT(cpt) ]
[ OPT(a)[IT(size)/[IT(P_symbol)/[IT(T_symbol)]]] ] [ GMT_c_OPT ]
[ OPT(e)IT(fill) ] [ OPT(g)IT(fill) ] [ GMT_H_OPT ] [ GMT_i_OPT ] 
[ OPT(p)IT(pen) ]
[ OPT(t)IT(pen) ] [ GMT_colon_OPT ]
.SH DESCRIPTION
BD(pscoupe) reads data values from IT(files) [or standard input] and
generates IT(PostScript) code that will plot symbols, lines or polygons on a cross-section.
Focal mechanisms  may be specified and require additional columns of data.
The IT(PostScript) code is written to standard output. 
#include "explain_commonitems.txt"
.SH REQUIRED ARGUMENTS
#include "explain_intables.txt"
.sp
A IT(new file) is created with the new coordinates (BD(x), BD(y)) and the
mechanism (from lower focal half-sphere for horizontal plane, to half-sphere
behind a vertical plane).
When the plane is not horizontal,
.br
- north direction becomes upwards steepest descent direction of the plane (u)
.br
- east direction becomes strike direction of the plane (s)
.br
- down direction (= north^east) becomes u^s
.br
Axis angles are defined in the same way as in horizontal plane in the new system.
.br
Moment tensor (initially in r, t, f system that is up, south, east)
is defined in (-u^s, -u, s) system.
#include "explain_-J.txt"
#include "explain_-Rgeo.txt"
If frame is defined from cross-section parameters (see OPT(A)) this option is not taken into account,
but must be present.
.TP
OPT(A)
selects the cross-section.
.TP
OPT(Aa)IT(lon1/lat1/lon2/lat2/dip/p_width/dmin/dmax)[BD(f)]
IT(lon) and IT(lat) are the longitude and latitude of points 1 and 2 limiting the length of the cross-section.
IT(dip) is the dip of the plane on which the cross-section is made.
IT(p_width) is the width of the cross-section on each side of a vertical plane
or above and under an oblique plane. 
IT(dmin) and IT(dmax) are the distances min and max from horizontal plane, 
along steepest descent direction.
Add BD(f) to get the frame from the cross-section parameters.
.TP
OPT(Ab)IT(lon1/lat1/strike/p_length/dip/p_width/dmin/dmax)[BD(f)]
IT(lon1) and IT(lat1) are the longitude and latitude of the beginning of the cross-section.
IT(strike) is the azimuth of the direction of the cross-section.
IT(p_length) is the length along which the cross-section is made.
The other parameters are the same as for OPT(Aa) option.
.TP
OPT(Ac)IT(x1/y1/x2/y2/dip/p_width/dmin/dmax)[BD(f)]
The same as OPT(Aa) option with IT(x) and IT(y) cartesian coordinates.
.TP
OPT(Ad)IT(x1/y1/strike/p_length/dip/p_width/dmin/dmax)[BD(f)]
The same as OPT(Ab) option with IT(x) and IT(y) cartesian coordinates.
.TP
OPT(S)
selects the meaning of the columns in the data file and the figure to be plotted.
.TP
OPT(Sa)IT(scale[/fontsize[/offset)[BD(u)]]]
Focal mechanisms in Aki and Richards convention.
IT(scale) adjusts the scaling of the radius of the "beach ball",
which will be proportional to the magnitude.  The IT(scale) is the size for
magnitude = 5 in BD(PROJ_LENGTH_UNIT) (unless BD(c), BD(i), BD(m), or BD(p) is
appended to indicate that the size information is in units of cm, inches,
meters, or points, respectively).  Use the OPT(T) option
to render the beach ball transparent by drawing only the nodal planes
and the circumference.  The color or shade of the compressive
quadrants can be specified with the OPT(G) option.  The color or shade
of the extensive quadrants can be specified with the OPT(E) option.
Parameters are expected to be in the following columns:
.RS
.TP
BD(1),BD(2):
longitude, latitude of event (OPT(:) option interchanges order)
.TPs
BD(3):
depth of event in kilometers
.TP
BD(4),BD(5),BD(6):
strike, dip and rake
.TP
BD(7):
magnitude
.TPs
BD(8),BD(9):
not used; can be 0 0; allows use of the psmeca file format
.TPs
BD(10):
text string to appear above the beach ball (default) or under (add BD(u)).
.RE
.TP
OPT(Sc)scale)
Focal mechanisms in Harvard CMT convention.  
IT(scale) adjusts the scaling of the radius of the "beach ball", which will
be proportional to the magnitude. The IT(scale) is the size for magnitude = 5
(that is M0 = 4E+23 dynes-cm.) in BD(PROJ_LENGTH_UNIT) (unless BD(c), BD(i),
BD(m), or BD(p) is appended to indicate that the size information is in
units of cm, inches, meters, or points, respectively).  Use the OPT(T) option
to render the beach ball transparent by drawing only the nodal planes
and the circumference. The color or shade of the compressive quadrants
can be specified with the OPT(G) option.  The color or shade
of the extensive quadrants can be specified with the OPT(E) option.
Parameters are expected to be in the following columns:
.RS
.TP
BD(1),BD(2):
longitude, latitude of event (OPT(:) option interchanges order)
.TP
BD(3):
depth of event in kilometers
.TP
BD(4),BD(5),BD(6):
strike, dip, and slip of plane 1
.TP
BD(7),BD(8),BD(9):
strike, dip, and slip of plane 2
.TP
BD(10),BD(11):
mantissa and exponent of moment in dyne-cm (if magnitude is uses instead of scalar moment, magnitude is in column 10 and 0 must be in column 11)
.TP
BD(12),BD(13):
not used; can be 0 0; allows use of the psmeca file format
.TP
BD(14):
text string to appear above the beach ball (default) or under (add BD(u)).
.RE
.TP
OPT(Sp)IT(scale[/fontsize[/offset)[BD(u)]]]
Focal mechanisms given with partial data on both planes.
IT(scale) adjusts the scaling of the radius of the "beach ball", which will
be proportional to the magnitude.  The IT(scale) is the size for magnitude
= 5 in BD(PROJ_LENGTH_UNIT) (unless BD(c), BD(i), BD(m), or BD(p) is appended
to indicate that the size information is in units of cm, inches, meters, or
points, respectively).  The color or shade of the compressive quadrants
can be specified with the OPT(G) option.  The color or shade of the extensive
quadrants can be specified with the OPT(E) option.
Parameters are expected to be in the following columns:
.RS
.TP
BD(1),BD(2):
longitude, latitude of event (OPT(:) option interchanges order)
.TP
BD(3):
depth
.TP
BD(4),BD(5):
strike, dip of plane 1
.TP
BD(6):
strike of plane 2
.TP
BD(7):
must be -1/+1 for a normal/inverse fault
.TP
BD(8):
magnitude
.TP
BD(9),BD(10):
not used; can be 0 0; allows use of the psmeca file format
.TP
BD(11):
text string to appear above the beach ball (default) or under (add BD(u)).
.RE
.TP
OPT(Sm|d|z)IT(scale[/fontsize[/offset)[BD(u)]]]
Seismic moment tensor (Harvard CMT, with zero trace).
IT(scale) adjusts the scaling of the radius of the "beach ball", which will
be proportional to the magnitude. The IT(scale) is the size for magnitude = 5
(that is seismic scalar moment = 4E+23 dynes-cm) in BD(PROJ_LENGTH_UNIT) (unless
BD(c), BD(i), BD(m), or BD(p) is appended to indicate that the size
information is in units of cm, inches, meters, or points, respectively).
(OPT(T)IT(0) option overlays best double couple transparently.) Put
OPT(Sd)IT(scale[/fontsize[/offset)[BD(u)]]] to plot the only double couple part
of moment tensor.  Put OPT(Sz)IT(scale[/fontsize[/offset)[BD(u)]]] to plot
anisotropic part of moment tensor (zero trace).  The color or shade of the
compressive quadrants can be specified with the OPT(G) option.  The color or
shade of the extensive quadrants can be specified with the OPT(E) option.
Parameters are expected to be in the following columns:
.RS
.TP
BD(1),BD(2):
longitude, latitude of event (OPT(:) option interchanges order)
.TP
BD(3):
depth of event in kilometers
.TP
BD(4),BD(5),BD(6),BD(7),BD(8),BD(9):
mrr, mtt, mff, mrt, mrf, mtf in 10*exponent dynes-cm
.TP
BD(10):
exponent
.TP
BD(11),BD(12):
Not used; can be 0 0; allows use of the psmeca file format
.TP
BD(13):
Text string to appear above the beach ball (default) or under (add BD(u)).
.RE
.TP
OPT(Sx)IT(scale[/fontsize[/offset)[BD(u)]]]
Principal axis.
IT(scale) adjusts the scaling of the radius of the "beach ball", which will
be proportional to the magnitude. The IT(scale) is the size for magnitude = 5
(that is seismic scalar moment = 4*10e+23 dynes-cm) in BD(PROJ_LENGTH_UNIT) (unless
BD(c), BD(i), BD(m), or BD(p) is appended to indicate that the size
information is in units of cm, inches, meters, or points, respectively).
(OPT(T0) option overlays best double couple transparently.) Put
OPT(Sy)IT(scale[/fontsize[/offset)[BD(u)]]] to plot the only double couple part
of moment tensor.  Put OPT(St)IT(scale[/fontsize[/offset)[BD(u)]]] to plot
anisotropic part of moment tensor (zero trace).  The color or shade of the
compressive quadrants can be specified with the OPT(G) option.  The color or
shade of the extensive quadrants can be specified with the OPT(E) option.
Parameters are expected to be in the following columns:
.RS
.TP
BD(1),BD(2):
longitude, latitude of event (OPT(:) option interchanges order)
.TP
BD(3):
depth of event in kilometers
.TP
BD(4),BD(5),BD(6),BD(7),BD(8),BD(9),BD(10),BD(11),BD(12):
value (in 10*exponent dynes-cm), azimuth, plunge of the T, N, and P axes.
.TP
BD(13):
exponent
.TP
BD(14),BD(15):
longitude, latitude at which to place beach ball. Entries in these
columns are necessary with the OPT(C) option.  Using 0,0 in columns
9 and 10 will plot the beach ball at the longitude, latitude given in
columns 1 and 2.  The OPT(:) option will interchange the order of
columns (1,2) and (9,10).
.TP
BD(16):
Text string to appear above the beach ball (optional).
.RE
.TP
OPT(s)IT(symbol[size[/fontsize[/offset)[BD(u)]]]
selects a symbol instead of mechanism.
Choose from the following:
(BD(c)) circle, (BD(d)) diamond, (BD(i)) itriangle, (BD(s)) square, (BD(t)) triangle, (BD(x)) cross.
IT(size) is the symbol size in BD(PROJ_LENGTH_UNIT) (unless BD(c), BD(i),
BD(m), or BD(p) is appended to indicate that the size information is in
units of cm, inches, meters, or points, respectively).  If IT(size) must be
read, it must be in column 4 and the text string will start in column 5.
Parameters are expected to be in the following columns:
.RS
.TP
BD(1),BD(2):
longitude, latitude of event (OPT(:) option interchanges order)
.TP
BD(3):
depth of event in kilometers
.TP
BD(4):
Text string to appear above the beach ball (default) or under (add BD(u)).
.RE
.SH OPTIONAL ARGUMENTS
#include "explain_-B.txt"
.TP
OPT(E)IT(fill)
Selects filling of extensive quadrants. Usually white.
Set the color [Default is white].
.TP
OPT(G)IT(fill)
Selects filling of focal mechanisms. By convention, the
compressional quadrants are shaded.  Set the color
[Default is black].  Optionally, specify
OPT(Gp)IT(icon_size/pattern), where )pattern) gives the
number of the image pattern (1-90) OR the name of a Sun rasterfile.
)icon_size) sets the unit size in inches.  To invert black and
white pixels, use OPT(GP) instead of OPT(Gp).  See
Appendix E for information on individual patterns.
#include "explain_-K.txt"
.TP
OPT(L)[IT(pen)]
Draws the "beach ball" outline using current pen (see OPT(W)) or sets pen attributes.
.TP
OPT(M)
Same size for any magnitude.
.TP
OPT(N)
Does BD(not) skip symbols that fall outside map border [Default plots points inside border only].
#include "explain_-O.txt"
#include "explain_-P.txt"
.TP
OPT(T)[IT(num_of_planes)]
Plots the nodal planes and outlines the bubble which is transparent.
If IT(num_of_planes) is
.br
IT(0): both nodal planes are plotted;
.br
IT(1): only the first nodal plane is plotted;
.br
IT(2): only the second nodal plane is plotted 
.br
[Default: 0].
#include "explain_-U.txt"
#include "explain_-V.txt"
.TP
OPT(W)
set pen attributes for text string or default pen attributes for fault plane edges. [Defaults: width = default, color =
black, style = solid]. 
#include "explain_-XY.txt"
.TP
OPT(Z)cptfile
Give a color palette file and let compressive part color be determined by the z-value in the
third column.
.TP
OPT(a)[IT(size)/[IT(P_axis_symbol)/[IT(T_axis_symbol)]]]
Computes and plots P and T axes with symbols. Optionally specify IT(size)
and (separate) P and T axis symbols from the following:
(BD(c)) circle, (BD(d)) diamond, (BD(h)) hexagon,
(BD(i)) inverse triangle,
(BD(p))point, (BD(s)) square, (BD(t)) triangle,
(BD(x)) cross. [Defaults: 0.2BD(c)/BD(c)/BD(c) or 0.08BD(i)/BD(c)/BD(c).]
.TP
OPT(e)IT(fill)
Selects filling of T axis symbol.
Set the color [Default is color of extensive parts.] 
.TP
OPT(g)IT(fill)
Selects filling of P axis symbol.
Set the color [Default is color of compressive parts.]
.TP
OPT(p)[IT(pen)]
Draws the P axis outline using current pen (see OPT(W)), or sets
pen attributes.
.TP
OPT(t)[IT(pen)]
Draws the T axis outline using current pen (see OPT(W)), or sets
pen attributes.
#include "explain_-c.txt"
#include "explain_-h.txt"
#include "explain_-icols.txt"
#include "explain_colon.txt"
#include "explain_help.txt"
.SH "SEE ALSO"
.IR GMT (1),
.IR psbasemap (1),
.IR psmeca (1),
.IR psxy (1)
.sp
.SH REFERENCES
Bomford, G., Geodesy, 4th ed., Oxford University Press, 1980.
.br
Aki, K. and P. Richards, Quantitative Seismology, Freeman, 1980.
.br
F. A. Dahlen and Jeroen Tromp, Theoretical Seismology, Princeton, 1998, p.167.
Definition of scalar moment.
.br
Cliff Frohlich, Cliff's Nodes Concerning Plotting Nodal Lines for P, Sh and Sv\"'
.br
Seismological Research Letters, Volume 67, Number 1, January-February, 1996
.br
Thorne Lay, Terry C. Wallace, Modern Global Seismology, Academic Press, 1995, p.384.
.br
W.H. Press, S.A. Teukolsky, W.T. Vetterling, B.P. Flannery, Numerical Recipes in C, Cambridge University press (routine jacobi)
.br
.SH AUTHOR
Genevieve Patau
.br
CNRS UMR 7580
.br
Seismology Dept.
.br
Institut de Physique du Globe de Paris
.br
(patau@ipgp.jussieu.fr)
