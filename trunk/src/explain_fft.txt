.TP
FFT_OPT[BD(f)|BD(q)|BD(s)|IT(nx/ny)][BD(+e)|BD(n)|BD(m)][BD(+t)IT(width)]
Choose or inquire about suitable grid dimensions for FFT.
OPT(Nf) will force the FFT to use the actual dimensions of the data.
OPT(Nq) will inQuire about more suitable dimensions, report those, then continue.
OPT(Ns) will present a list of optional dimensions, then exit.
OPT(N)IT(nx/ny) will do FFT on array size IT(nx/ny) (must be >= grid file size).
Default chooses dimensions >= data which optimize speed and accuracy of FFT.
If FFT dimensions > grid file dimensions, data are extended and tapered to zero.
Use modifiers to control how the extension and tapering are to be performed:
BD(+e) extends the grid by imposing edge-point symmetry [Default], BD(+m) extends
the grid by imposing edge mirror symmetry, while BD(+n) turns off data extension.
Tapering is performed from the data edge to the FFT grid edge [100%]. Change
this percentage via BD(+t)IT(width). When BD(+n) is in effect, the tapering
is applied instead to the data margins as no extension is available [0%].
For detailed investigation you can save the intermediate grid being passed to the
forward FFT; this is likely to have been
detrended, extended by point-symmetry along all edges, and tapered.  Append BD(+q)[IT(suffix)]
from which output file name(s) will be created (i.e., IT(ingrid)_IT(prefix).IT(ext)) [tapered].
Finally, you may save the complex grid produced by the forward FFT by appending BD(+z)
By default we write the real and imaginary components to IT(ingrid)_IT(real).IT(ext) and IT(ingrid)_imag.IT(ext).  Append BD(p) to save instead the polar form of magnitude and phase to files IT(ingrid)_mat.IT(ext) and IT(ingrid)_phase.IT(ext).
.TP
OPT(S)IT(scale)
Multiply each element by IT(scale) in the space domain (after the frequency domain operations).
[Default is 1.0].
#include "explain_-V.txt" 
#include "explain_help.txt"
#include "explain_grd_inout.txt"
.SH CONSIDERATIONS
netCDF COARDS grids will automatically be recognized as geographic. For other grids geographical grids
were you want to convert degrees into meters, select OPT(fg).  If the data are close to either pole,
you should consider projecting the grid file onto a rectangular coordinate system using BD(grdproject).
.SH EXAMPLES
To upward continue the sea-level magnetic anomalies in the file mag_0.nc to a level 800 m above sealevel:
.br
.sp
grdfft mag_0.nc -C800 -V -Gmag_800.nc 
.br
.sp
To transform geoid heights in m (geoid.nc) on a geographical grid to free-air gravity anomalies in mGal:
.br
.sp
grdfft geoid.nc -Dg -V -Ggrav.nc
.br
.sp
To transform gravity anomalies in mGal (faa.nc) to deflections of the vertical (in micro-radians) in the
038 direction, we must first integrate gravity to get geoid, then take the directional derivative, and
finally scale radians to micro-radians:
.br
.sp
grdfft faa.nc -Ig -A38 -S1e6 -V -Gdefl_38.nc
.br
.sp
Second vertical derivatives of gravity anomalies are related to the curvature of the field.  We can
compute these as mGal/m^2 by differentiating twice:
.br
.sp
grdfft gravity.nc -D -D -V -Ggrav_2nd_derivative.nc
.br
.sp
To compute cross-spectral estimates for co-registered bathymetry and gravity grids,
and report result as functions of wavelengths in km, try
br
.sp
grdfft bathymetry.nc gravity.grd -Ewk -fg -V > cross_spectra.txt
.br
.sp
To examine the pre-FFT grid after detrending, point-symmetry reflection, and tapering has been applied,
as well as saving the real and imaginary components of the raw spectrum of the data in topo.nc, try
.br
.sp
grdfft topo.nc -Q -Z -fg -V
.br
.sp
You can now make plots of the data in topo_taper.nc, topo_real.nc, and topo_imag.nc.
.SH "SEE ALSO"
.IR gmt (1),
.IR grdedit (1),
.IR grdmath (1),
.IR grdproject (1)
