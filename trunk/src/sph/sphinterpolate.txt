#include "common_options.txt"
.TH SPHINTERPOLATE 1 MANDATE GMT_STRING "Generic Mapping Tools"
#define LEN 15
#define SCALE \fB\-JM\fP15\fBc\fP
.SH NAME
sphinterpolate \- Gridding in tension of spherical data
.SH SYNOPSIS
\fBsphinterpolate\fP \fIinfiles\fP OPT(G)\fIgrdfile\fP [ OPT(F) ] [ GMT_H_OPT ] [ GMT_I_OPT ] 
[ OPT(L) ] [ GMT_M_OPT ] [ OPT(Q)\fImode\fP[/\fIE\fP/\fIU\fP] ] [ GMT_Rgeo_OPT ] [ GMT_V_OPT ] [ OPT(Z) ] [ GMT_t_OPT ] [ GMT_b_OPT ]
.SH DESCRIPTION
\fBsphinterpolate\fP reads one or more ASCII [or binary] files (or standard input) containing lon, lat, f and
performs a Delaunay triangulation to set up a spherical interpolation in tension.  The final grid is saved
to the specified file.  Several options may be used to affect the outcome, such as choosing local versus global gradient
estimation or optimize the tension selection to satisfy one of four criteria.
.TP
\fIinfiles\fP
Data files with the (lon, lat, f) coordinates in ASCII (or binary; see \OPT(b)).  If no files are given the standard input is read.
.SH OPTIONS
#include "explain_-H.txt"
#include "explain_-I.txt"
.TP
\OPT(L)
Use a local method, in which values depend only on nearby data points, to compute
estimated gradients at the nodes [Default uses a global method in which values depend on all the data].
.TP
\OPT(M)
Expect input data to have multiple line segments separated by a record whose first
character is \fIflag\fP [>].
.TP
\OPT(Q)
Specify one of four ways to calculate tension factors to preserve local shape properties or
satisfy arc constraints [Default is no tension].
.TP
\OPT(Q)0
Piecewise linear interpolation; no tension is applied.
.TP
\OPT(Q)Q1
Smooth interpolation with local gradient estimates.
.TP
\OPT(Q)Q2
Smooth interpolation with global gradient estimates.
.TP
\OPT(Q)Q3
Smoothing.  Optionally append \fI/E/U\fP [/0/0], where
\fIE\fP is Expected squared error in a typical (scaled) data value, and
\fIU\fP is Upper bound on  weighted sum of squares of deviations from data.
#include "explain_-Rgeo.txt"
.TP
\OPT(T)
Use variable tension (ignored with \OPT(Q)0 [constant]
#include "explain_-V.txt"
.TP
\OPT(Z)
Before interpolation, scale data by the maximum data range [no scaling].
#include "explain_-t.txt"
#include "explain_-bi.txt"
[Default is 3 input columns].
#include "explain_-bo.txt"
[Default is same as input].
#include "explain_precision.txt"
#include "explain_float.txt"
.SH EXAMPLES
To interpolate the points in the file testdata.txt on a global 1x1 degree grid with no tension, use
.br
.sp
\fBsphinterpolate\fP testdata.txt \fB\-Rg \-I\fP1 \fB\-G\fPsolution.grd
.br
.sp
To generate the same grid in two steps using \fBsphtriangulate\fP separately, try
.br
.sp
\fBsphtriangulate\fP testdata.txt \fB\-Qv\fP > voronoi.d
.br
\fBsphinterpolate\fP \fB\-Q\fPvoronoi.d \fB\-Rg \-I\fP1 \fB\-G\fPglobedist.grd
.SH "SEE ALSO"
.IR GMT (1),
.IR sphdistance (1)
.IR sphtriangulate (1)
.IR triangulate (1)
.SH REFERENCES
Renka, R, J., 1997, Algorithm 772: STRIPACK: Delaunay Triangulation and Voronoi Diagram on the Surface of a Sphere, 
\fIAMC Trans. Math. Software, 23\fP (3), 416\-434.
.br
Renka, R, J,, 1997, Algorithm 773: SSRFPACK: Interpolation of scattered
data on the Surface of a Sphere with a surface under tension,
\fIAMC Trans. Math. Software, 23\fP (3), 435-442.
