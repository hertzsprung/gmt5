%-	$Id: PSL_prologue.ps,v 1.27 2010-04-19 15:44:43 remko Exp $
%-	Make sure that the version number matches the one mentioned in pslib.c
% Begin pslib header
250 dict begin
/! {bind def} bind def
/# {load def}!
/A /setgray #
/B /setdash #
/C /setrgbcolor #
/D /rlineto #
/E {dup stringwidth pop}!
/F /fill #
/G /rmoveto #
/H /sethsbcolor #
/I /setpattern #
/K /setcmykcolor #
/L /lineto #
/M {stroke moveto}!
/m /moveto #
/N /newpath #
/P /closepath #
/R /rotate #
/S /stroke #
/T /translate #
/U /grestore #
/V /gsave #
/W /setlinewidth #
/Y {findfont exch scalefont setfont}!
/Z /show #
/FP {true charpath flattenpath}!
/MS {/savematrix matrix currentmatrix def}!
/MR {savematrix setmatrix}!
% Point
/O {S 3 -1 roll 0 360 arc P F S}!
% Cross
/X {M 1.414213562 mul 5 {dup} repeat -2 div dup G D neg 0 G neg D S}!
% Plus
/x {M dup 0 G dup -2 mul dup 0 D exch dup G 0 exch D S}!
% Path fill
/FS {/fc exch def /fs {V fc F U} def}!
/FQ {/fs {} def}!
% Outline off or on
/O0 {/os {N} def}!
/O1 {/os {S} def}!
% Patch fill
/SP {M {D} repeat P fs os}!
% Single-headed vector
/SV {0 exch M 0 D D D D D 0 D P fs os}!
% Double-headed vector
/Sv {0 0 M D D 0 D D D D D 0 D D P fs os}!
% Box
/SB {M dup 0 D exch 0 exch D neg 0 D P fs os}!
% Circle
/SC {S 3 -1 roll 0 360 arc P fs os}!
% Ellipse
/SE {S MS T R scale 0 0 1 0 360 arc MR P fs os}!
% Diamond
/SD {M 4 {dup} repeat 0 G neg dup dup D exch D D P fs os}!
% Rectangle
/SR {M MS R dup -2 div 0 G exch dup -2 div 0 exch G exch dup 0 D exch 0 exch D neg 0 D MR P fs os}!
% Square
/SS {M 1.414213562 mul dup dup dup -2 div dup G 0 D 0 exch D neg 0 D P fs os}!
% Triangle
/ST {M MS dup 0 exch G -60 R 1.732050808 mul dup 0 D -120 R 0 D MR P fs os}!
% Inverted triangle
/SI {M MS dup neg 0 exch G 60 R 1.732050808 mul dup 0 D 120 R 0 D MR P fs os}!
% Star
/SA {M MS dup 0 exch G 0.726542528 mul -72 R dup 0 D 4 {72 R dup 0 D -144 R dup 0 D} repeat pop MR P fs os}!
% Hexagon
/SH {M MS dup 0 G -120 R dup 0 D 4 {-60 R dup 0 D} repeat pop MR P fs os}!
% Pentagon
/SN {M MS dup 0 exch G -36 R 1.175570505 mul dup 0 D 3 {-72 R dup 0 D} repeat pop MR P fs os}!
% Octagon
/SO {M MS 22.5 R dup 0 exch G -22.5 R 0.765366865 mul dup 0 D 6 {-45 R dup 0 D} repeat pop MR P fs os}!
% Pie Wedge
/SW {S 2 copy 7 -3 roll arc L P fs os}!
% To reencode one font with the provided encoding vector
/PSL_reencode {findfont dup length dict begin
  {1 index /FID ne {def}{pop pop} ifelse} forall
  exch /Encoding exch def currentdict end definefont pop
}!
/PSL_eps_begin {					% Marks begin of EPSF inclusion
  /PSL_eps_state save def				% Save state for cleanup
  /PSL_dict_count countdictstack def			% Count objects on dict stack
  /PSL_op_count count 1 sub def				% Count objects on operand stack
  userdict begin					% Push userdict stack
  /showpage {} def					% Deactivate showpage command
  0 setgray 0 setlinecap 1 setlinewidth			% Prepare clean graphics state
  0 setlinejoin 10 setmiterlimit [] 0 setdash newpath
  /languagelevel where	% If level != 1, set strokeadjust and overprint to their defaults
  {pop languagelevel 1 ne {false setstrokeadjust false setoverprint} if} if
}!
/PSL_eps_end {						% Marks end of EPSF inclusion
  count PSL_op_count sub {pop} repeat			% Clean up operand stack
  countdictstack PSL_dict_count sub {end} repeat	% Clean up dict stack
  PSL_eps_state restore					% Restore saved state
}!
