#include "common_options.txt"
.TH GRDVIEW 1 MANDATE GMT_STRING "Generic Mapping Tools"
#define LEN_1	1.5
#define LEN_2	20
#define LEN_3	6
#define SCALE1	OPT(Jl)18/24/1.5\fBc\fP
#define ZSCALE1	OPT(Jz)0.05\fBc\fP
#define SCALE2	OPT(Jx)10.0\fBc\fP
#define SCALE3 OPT(JM)6\fBi\fP
.SH NAME
grdview \- Create 3-D perspective grayshaded/colored image or mesh from a 2-D grid file
.SH SYNOPSIS
\fBgrdview\fP \fIrelief_file\fP GMT_J_OPT 
[ GMT_B_OPT ] [ OPT(C)\fIcptfile\fP] [ GMT_E_OPT ] 
[ OPT(G)\fIdrapefile\fP | OPT(G)\fIgrd_r\fP,\fIgrd_g\fP,\fIgrd_b\fP ] [ OPT(I)\fIintensfile\fP] [ GMT_Jz_OPT ] [ GMT_K_OPT ] 
[ OPT(L)[\fIflags\fP] ] [ OPT(N)\fIlevel\fP[/\fIcolor\fP]] [ GMT_O_OPT ] [ GMT_P_OPT ] 
[ OPT(Q)\fItype\fP[\fBg\fP] ] [ GMT_Rgeoz_OPT ] [ OPT(S)\fIsmooth\fP ] 
[ OPT(T)[\fBs\fP][\fBo\fP[\fIpen\fP]] ] [ GMT_U_OPT ] [ GMT_V_OPT ] [ OPT(W)\fItype/pen\fP ] [ GMT_X_OPT ]
[ GMT_Y_OPT ] [ OPT(Z)\fIzlevel\fP ] [ GMT_c_OPT ]
.SH DESCRIPTION
\fBgrdview\fP reads a 2-D grid file and produces a 3-D perspective plot by 
drawing a mesh, painting a colored/grayshaded surface made up of polygons, or by scanline conversion of these polygons
to a rasterimage.  Options include draping a data set on top of a surface, plotting of contours on top of the
surface, and apply artificial illumination based on intensities provided in a separate grid file.
.TP
\fIrelief_file\fP
2-D gridded data set to be imaged (the relief of the surface).
(See GRID FILE FORMAT below.)
#include "explain_-J_short.txt"
#include "explain_-Jz.txt"
.SH OPTIONS
No space between the option flag and the associated arguments.
#include "explain_-B_short.txt"
.TP
OPT(C)
name of the color palette file.  Must be present if you want (1) mesh plot with
contours (OPT(Qm)), or (2) shaded/colored perspective image (OPT(Qs) or OPT(Qi)).
For OPT(Qs): You can specify that you want to skip a z-slice by setting red = -; to
use a pattern give red = \fBP|p\fP\fIdpi/pattern\fP[:\fBF\fP\fIr/g/b\fP[\fBB\fP\fIr/g/b\fP]].
#include "explain_-E.txt"
.TP
OPT(G)
Drape the image in \fIdrapefile\fP on top of the relief provided by \fIrelief_file\fP. [Default is \fIrelief_file\fP].
Note that OPT(Jz) and OPT(N) always refers to the \fIrelief_file\fP.  The \fIdrapefile\fP only provides
the information pertaining to colors, which is looked-up via the cpt file (see OPT(C)).  Alternatively, give
three grid files separated by commas.  These files must contain the red, green, and blue colors directly (in 0-255 range)
and no cpt file is needed.  The \fIdrapefile\fP may be of higher resolution than the \fIrelief_file\fP.
.TP
OPT(I)
Gives the name of a grid file with intensities in the (-1,+1) range. [Default is no illumination].
#include "explain_-K.txt"
.TP
OPT(L)
Boundary condition \fIflags\fP may be \fIx\fP or \fIy\fP or \fIxy\fP indicating data is periodic in range of
x or y or both, or \fIflags\fP may be \fIg\fP indicating geographical conditions (x and y are
lon and lat).  [Default uses "natural" conditions (second partial derivative normal to edge is zero).]
If no \fIflags\fP are set, use bilinear rather than the default bicubic resampling when draping is required.
.TP
OPT(N)
Draws a plane at this z-level.  If the optional \fIcolor\fP is provided, the frontal facade between
the plane and the data perimeter is colored.  See OPT(Wf) for setting the pen used for the outline.
(See SPECIFYING COLOR below).
#include "explain_-O.txt"
#include "explain_-P.txt"
.TP
OPT(Q)
Select one of four settings: 1. Specify \fBm\fP for mesh plot [Default], and optionally append /\fIcolor\fP for a different mesh paint [white].
2. Specify \fBs\fP for surface plot, and optionally append \fBm\fP to have mesh lines drawn on top of surface.
3. Specify \fBi\fP for image plot, and optionally append the effective dpi resolution for the rasterization [100].
4. Specify \fBc\fP.  Same as OPT(Qi) but will make nodes with z = NaN transparent,
using the colormasking feature in \fIPostScript\fP Level 3 (the PS device must support PS Level 3).
For any of these choices, you may force a monochrome image by appending \fBg\fP.  Colors are then
converted to shades of gray using the (television) YIQ transformation.
#include "explain_-R.txt"
This option may be used to indicate the range used for the 3-D axes [Default is
region given by the \fIrelief_file\fP].  You may ask for a larger
\fIw/e/s/n\fP region to have more room between the image and the axes.  A smaller region
than specified in the \fIrelief_file\fP will result in a subset of the grid.
.TP
OPT(S)
Smooth the contours before plotting (see \fBgrdcontour\fP) [Default is no smoothing].
.TP
OPT(T)
Plot image without any interpolation.  This involves converting each node-centered
bin into a polygon which is then painted separately.  Append \fBs\fP to skip
nodes with z = NaN.  This option is useful for categorical data where
interpolating between values is meaningless.  Optionally, append \fBo\fP to
draw the tile outlines, and specify a custom pen if the default pen is not to
your liking.  As this option produces a flat surface it cannot be combined with OPT(JZ) or OPT(Jz).
(See SPECIFYING PENS below).
#include "explain_-U.txt"
#include "explain_-V.txt"
.TP
OPT(Wc)
Draw contour lines on top of surface or mesh (not image).  Append pen attributes used for the contours.
[Default: width = 0.75p, color = black, texture = solid].
(See SPECIFYING PENS below).
.TP
OPT(Wm)
Sets the pen attributes used for the mesh. [Default: width = 0.25p, color = black, texture = solid].
You must also select OPT(Qm) or OPT(Qsm) for meshlines to be drawn.
.TP
OPT(Wf)
Sets the pen attributes used for the facade. [Default: width = 0.25p, color = black, texture = solid].
You must also select OPT(N) for the facade outline to be drawn.
(See SPECIFYING PENS below).
#include "explain_-XY.txt"
.TP
OPT(Z)
Sets the z-level of the basemap [0].
#include "explain_-c.txt"
#include "explain_pen.txt"
#include "explain_color.txt"
#include "explain_grd_input.txt"
.SH EXAMPLES
To make a mesh plot from the file hawaii_grav.grd and drawing the contours
given in the color palette file hawaii.cpt on a Lambert map
at LEN_1 cm/degree along the standard parallels 18 and 24, with vertical scale LEN_2 mgal/cm, and
looking at the surface from SW at 30 degree elevation, run 
.br
.sp
\fBgrdview\fP hawaii_grav.grd SCALE1 OPT(C)hawaii.cpt ZSCALE1 OPT(Qm) OPT(N)-100 OPT(E)225/30 OPT(Wc) > hawaii_grav_image.ps
.br
.sp
To create a illuminated color perspective plot of the gridded data set image.grd, using the color
palette file color.rgb, with linear scaling at 10 cm/x-unit
and tickmarks every 5 units, with intensities provided by the file intens.grd, and looking from the SE, use
.br
.sp
\fBgrdview\fP image.grd SCALE2 OPT(C)color.rgb OPT(Qs) OPT(E)135/30 OPT(I)intens.grd  > image3D.ps
.br
.sp
To make the same plot using the rastering option with dpi = 50, use
.br
.sp
\fBgrdview\fP image.grd SCALE2 OPT(C)color.rgb OPT(Qi)50 OPT(E)135/30 OPT(I)intens.grd  > image3D.ps
.br
.sp
To create a color \fIPostScript\fP perspective plot of the gridded data set magnetics.grd, using the color
palette file mag_intens.cpt, draped over the relief given by the file topography.grd, with Mercator map width of LEN_3 inch
and tickmarks every 1 degree, with intensities provided by the file topo_intens.grd, and looking from the SE, run
.br
.sp
\fBgrdview\fP topography.grd SCALE3 OPT(G)magnetics.grd OPT(C)mag_intens.cpt OPT(Qs) OPT(E)140/30 OPT(I)topo_intens.grd  > draped3D.ps
.br
.sp
Given topo.grd and the Landsat image veggies.ras, first run \fBgmt2rgb\fP to get the red, green, and blue grids, and then drape
this image over the topography and shade the result for good measure.  The commands are
.br
.sp
\fBgmt2rgb\fP veggies.ras OPT(G)layer_%c.grd
.br
\fBgrdview\fP topo.grd SCALE3 OPT(Qi) OPT(E)140/30 OPT(I)topo_intens.grd OPT(G)layer_r.grd,layer_g.grd,layer_b.grd > image.ps
.SH REMARKS
For the OPT(Qs) option:  \fIPostScript\fP provides no way of smoothly varying colors within a polygon, so colors can only
vary from polygon to polygon.  To obtain smooth images this way you may resample the grid file(s) using \fBgrdsample\fP or
use a finer grid size when running gridding programs like \fBsurface\fP or \fBnearneighbor\fP.  Unfortunately,
this produces huge \fIPostScript\fP files.  The alternative is to use the OPT(Qi) option, which
computes bilinear or bicubic continuous color variations within polygons by using scanline conversion to image the polygons.
.SH "SEE ALSO"
.IR GMT (1),
.IR gmt2rgb (1),
.IR gmtcolors (5),
.IR grdcontour (1),
.IR grdimage (1),
.IR nearneighbor (1),
.IR psbasemap (1),
.IR pscontour (1),
.IR pstext (1),
.IR surface (1)
