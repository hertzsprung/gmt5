#include "common_options.txt"
.TH GRD2CPT 1 MANDATE GMT_STRING "Generic Mapping Tools"
.SH NAME
grd2cpt \- Make linear or histogram-equalized color palette table from grid
.SH SYNOPSIS
BD(grd2cpt) IT(grid) [ OPT(A)[BD(+)]IT(transparency) ] [ OPT(C)IT(cptmaster) ] 
[ OPT(D)[BD(i)|BD(o)] ] [ OPT(E)IT(nlevels) ]
[ OPT(F)[BD(R)|BD(r)|BD(h)|BD(c) ] [ OPT(I) ] 
[ OPT(L)IT(minlimit/maxlimit) ] [ OPT(M) ] [ OPT(N) ] [ OPT(Q)[BD(i)|BD(o)] ] [ GMT_Rgeo_OPT ] 
[ OPT(S)IT(zstart/zstop/zinc) ] [ OPT(T)BD(-)|BD(+)|BD(_)|BD(=) ] [ GMT_V_OPT ]
[ OPT(W) ] [ OPT(Z) ]
.SH DESCRIPTION
BD(grd2cpt) reads one or more grid files and writes a color palette (cpt) file to
standard output.  The cpt file is based on an existing master cpt file of
your choice, and the mapping from data value to colors is through the
data's cumulative distribution function (CDF), so that the colors are\"'
histogram equalized.  Thus if the grid(s) and the resulting cpt file are used in
BD(grdimage) with a linear projection, the colors will be uniformly
distributed in area on the plot.  Let z be the data values in the grid. 
Define CDF(Z) = (# of z < Z) / (# of z in grid).  (NaNs are ignored).
These z-values are then normalized to the master cpt file and colors are
sampled at the desired intervals.
.sp
The color palette includes three additional colors beyond the range of z-values. These are
the background color (B) assigned to values lower than the lowest IT(z)-value,
the foreground color (F) assigned to values higher than the highest IT(z)-value,
and the NaN color (N) painted whereever values are undefined.
.sp
If the master cpt file includes B, F, and N entries, these will be copied into the new master file.
If not, the parameters BD(COLOR_BACKGROUND), BD(COLOR_FOREGROUND), and BD(COLOR_NAN) from
the BD(gmt.conf) file or the command line will be used. This default behavior can be overruled
using the options OPT(D), OPT(M) or OPT(N).
.sp
The color model (RGB, HSV or CMYK) of the palette created by BD(makecpt) will be the same as
specified in the header of the master cpt file. When there is no BD(COLOR_MODEL) entry in the
master cpt file, the BD(COLOR_MODEL) specified in the BD(gmt.conf) file or on the command line
will be used.
#include "explain_commonitems.txt"
.SH REQUIRED ARGUMENTS
.TP
IT(grid)
Names of one or more grid files used to derive the color palette table.
All grids need to have the same size and dimensions.
(See GRID FILE FORMATS below).
.SH OPTIONAL ARGUMENTS
.TP
OPT(A)[BD(+)]IT(transparency)
Sets a constant level of transparency (0\-100) for all color slices.  Prepend BD(+) to also
affect the fore-, back-, and nan-colors [Default is no transparency, i.e., 0 (opaque)].
.TP
OPT(C)IT(cptmaster)
Selects the master color table to use in the interpolation.  Choose among
the built-in tables (type BD(grd2cpt) to see the list) or give the
name of an existing cpt file [Default gives a rainbow cpt file].
.TP
OPT(D)[BD(i)|BD(o)]
Select the back- and foreground colors to match the colors for lowest and highest IT(z)-values
in the output cpt file [Default uses the colors specified in the master file, or those defined by 
the parameters BD(COLOR_BACKGROUND), BD(COLOR_FOREGROUND), and BD(COLOR_NAN)].
Append BD(i) to match the colors for the lowest and highest values in the input (instead of the output) cpt file.
.TP
OPT(E)IT(nlevels)
Create a linear color table by dividing the grid z-range into IT(nlevels) equidistant slices.
.TP
OPT(F)[BD(R)|BD(r)|BD(h)|BD(c)]
Force output cpt file to written with r/g/b codes, gray-scale values or color name (BD(R), default)
or r/g/b codes only (BD(r)), or h-s-v codes (BD(h)), or c/m/y/k codes (BD(c)).
.TP
OPT(I)
Reverses the sense of color progression in the master cpt file.
Also exchanges the foreground and background colors, including those specified by
the parameters BD(COLOR_BACKGROUND) and BD(COLOR_FOREGROUND).
.TP
OPT(L)IT(minlimit/maxlimit)
Limit range of cpt file to IT(minlimit/maxlimit), and don't count data\"'
outside range when estimating CDF(Z).  [Default uses min and max of data.] 
.TP
OPT(M)
Overrule background, foreground, and NaN colors specified in the master cpt file with the values of
the parameters BD(COLOR_BACKGROUND), BD(COLOR_FOREGROUND), and BD(COLOR_NAN) specified in
the BD(gmt.conf) file or on the command line.
When combined with OPT(D), only BD(COLOR_NAN) is considered.
.TP
OPT(N)
Do not write out the background, foreground, and NaN-color fields [Default will write them].
.TP
OPT(Q)[BD(i)|BD(o)]
Selects a logarithmic interpolation scheme [Default is linear].  OPT(Qi) expects input z-values to be log10(z), assigns colors, and writes out z [Default].
OPT(Qo) takes log10(z) first, assigns colors, and writes out z.
#include "explain_-R.txt"
.TP
OPT(S)IT(zstart/zstop/zinc) or OPT(S)IT(n)
Set steps in cpt file.  Calculate entries in cpt file from IT(zstart) to IT(zstop)
in steps of (IT(zinc)).  Default chooses arbitrary values by a crazy scheme.
Use OPT(S)IT(n) to select IT(n) points from a cumulative normal distribution.
.TP
OPT(T)BD(-)|BD(+)|BD(_)|BD(=)
Force the color table to be symmetric about zero (from -R to +R). Append flag to set the range R:
BD(-) for R =|zmin|, BD(+) for R = |zmax|, BD(_) for R = min(|zmin|, |zmax|), or
BD(=) for R = max(|zmin|, |zmax|).
.TP
OPT(V)
Verbose operation.  This will write CDF(Z) estimates to stderr.  [Default is silent.] 
.TP
OPT(W)
Do not interpolate the input color table but pick the output colors starting at the beginning of the map.
This is particularly useful in combination with a categorical color table. Cannot be used in combination with OPT(Z).
.TP
OPT(Z)
Will create a continuous color palette.
[Default is discontinuous, i.e., constant color intervals]
#include "explain_help.txt"
#include "explain_grd_input.txt"
.SH EXAMPLES
Sometimes you don't want to make a cpt file (yet) but would find it helpful\"'
to know that 90% of your data lie between z1 and z2, something you cannot
learn from BD(grdinfo).  So you can do this to see some points on the
CDF(Z) curve (use OPT(V) option to see more):
.br
.sp
    grd2cpt mydata.nc -V > /dev/null
.sp
To make a cpt file with entries from 0 to 200 in steps of 20, and ignore
data below zero in computing CDF(Z), and use the built-in master cpt file
relief, run
.sp
    grd2cpt mydata.nc -Crelief -L0/10000 -S0/200/20 > mydata.cpt
.SH "SEE ALSO"
.IR gmt (1),
.IR gmt.conf (5),
.IR grdhisteq (1),
.IR grdinfo (1),
.IR makecpt (1)
