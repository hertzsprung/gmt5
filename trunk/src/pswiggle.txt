#include "common_options.txt"
.TH PSWIGGLE 1 MANDATE GMT_STRING "Generic Mapping Tools"
#define LEN 15
#define SCALE_S OPT(JS)0/90/15\fBc\fP
.SH NAME
pswiggle \- Plot anomaly along track on a map
.SH SYNOPSIS
\fBpswiggle\fP \fIxyz_files\fP GMT_J_OPT GMT_Rgeo_OPT 
OPT(Z)\fIscale\fP [ OPT(A)\fIazimuth\fP ] [ GMT_B_OPT ] [ OPT(C)\fIcenter\fP ] [ OPT(D)\fIgap\fP ] 
[ GMT_E_OPT ] [ OPT(G)\fIfill\fP ] [ GMT_H_OPT ] [ GMT_Jz_OPT ] 
[ OPT(I)\fIfix_az\fP ] [ GMT_K_OPT ] [ OPT(N) ] [ GMT_O_OPT ] [ GMT_P_OPT ] 
[ OPT(S)[\fBx\fP]\fIlon0\fP/\fIlat0\fP/\fIlength\fP[/\fIunits\fP] ] [ OPT(T)\fIpen\fP ] 
[ GMT_U_OPT ] [ GMT_V_OPT ] [ OPT(W)\fIpen\fP ] [ GMT_X_OPT ] 
[ GMT_Y_OPT ] [ GMT_c_OPT ] [ GMT_t_OPT ] [ GMT_bi_OPT ] [ GMT_fi_OPT ] [ GMT_m_OPT ]
.SH DESCRIPTION
\fBpswiggle\fP reads (\fIx\fP,\fIy\fP,\fIz\fP) triplets from files [or standard input] and plots z as a function of
distance along track.  This means that two consecutive (\fIx\fP,\fIy\fP) points define the local distance axis,
and the local \fIz\fP axis is then perpendicular to the distance axis.  The user may set a preferred
positive anomaly plot direction, and if the positive normal is outside
the plus/minus 90 degree window around the preferred direction, then 180 degrees are added to the
direction.  Either the positive or the negative wiggle may be shaded.  The resulting \fIPostScript\fP
code is written to standard output.
.TP
\fIfiles\fP
List one or more file-names. If no files are given, \fBpswiggle\fP will read standard input.
#include "explain_-J_short.txt"
#include "explain_-R.txt"
.TP
OPT(Z)
Gives anomaly scale in data-units/distance-unit.
.SH OPTIONS
No space between the option flag and the associated arguments.
.TP
OPT(A)
Sets the preferred positive azimuth.  Positive wiggles will "gravitate" towards that
direction.
#include "explain_-B_short.txt"
.TP
OPT(C)
Subtract \fIcenter\fP from the data set before plotting [0].
.TP
OPT(D)
Means there is a data gap if 2 consecutive points are more than \fIgap\fP distance
units apart.  For longitude/latitude data \fIgap\fP is in km, else it is in the
user's units.\"'
#include "explain_-E.txt"
.TP
OPT(G)
Set fill shade, color or pattern of positive wiggles [Default is black]
(See SPECIFYING FILL below).
#include "explain_-H.txt"
.TP
OPT(I)
Set a fixed azimuth projection for wiggles [Default uses track azimuth, but see OPT(A)].
#include "explain_-K.txt"
.TP
OPT(N)
Paint negative wiggles instead of positive [Default].
#include "explain_-O.txt"
#include "explain_-P.txt"
.TP
OPT(S)
Draws a simple vertical scale centered on \fIlon0/lat0\fP.  Use OPT(Sx) to specify cartesian coordinates instead.
\fIlength\fP is in z units, append unit name for labeling
.TP
OPT(T)
Draw track  [Default is no track].  Append pen attributes to use [Defaults: width = 1, color = black, texture = solid].
(See SPECIFYING PENS below).
#include "explain_-U.txt"
#include "explain_-V.txt"
.TP
OPT(W)
Draw wiggle outline  [Default is no outline].  Append pen attributes to use
[Defaults: width = 1, color = black, texture = solid].
(See SPECIFYING PENS below).
#include "explain_-XY.txt"
#include "explain_-t.txt"
#include "explain_-bi.txt"
[Default is 3 input columns].
#include "explain_-c.txt"
#include "explain_-f.txt"
#include "explain_-m.txt"
#include "explain_pen.txt"
#include "explain_fill.txt"
#include "explain_color.txt"
.SH EXAMPLES
To plot the magnetic anomaly stored in the file track.xym along track @ 1000 nTesla/cm (after removing a mean value of 32000 nTesla),
using a LEN-cm-wide Polar Stereographic map ticked
every 5 degrees in Portrait mode, with positive anomalies in red on a blue track of width 0.25 points, use
.br
.sp
\fBpswiggle\fP track.xym OPT(R)-20/10/-80/-60 SCALE_S OPT(Z)1000 OPT(B)5 OPT(C)32000 OPT(P) OPT(G)red OPT(T)0.25\fBp\fP,blue
OPT(S)1000 OPT(V) > track_xym.ps
.SH BUGS
Sometimes the (x,y) coordinates are not printed with enough significant
digits, so the local perpendicular to the track swings around a lot.  To
see if this is the problem, you should do this:
.br
.sp
awk '{ if (NR > 1) print atan2(y-$1, x-$2); y=$1; x=$2; }' yourdata.xyz | more
.br
.sp
(note that output is in radians; on some machines you need "nawk" to do this).
Then if these numbers jump around a lot, you may do this:
.br
.sp
awk '{ print NR, $0 }' yourdata.xyz | \fBfilter1d\fP OPT(Fb)5 OPT(N)4/0 PAR(D_FORMAT,\fP%.12lg) > smoothed.xyz
.br
.sp
and plot this data set instead.
.SH "SEE ALSO"
.IR GMT (1),
.IR gmtcolors (1),
.IR filter1d (1),
.IR psbasemap (1),
.IR splitxyz (1)
