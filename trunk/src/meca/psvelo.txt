#include "common_options.txt"
.TH PSVELO 1 MANDATE GMT_STRING "Generic Mapping Tools"
.SH NAME
psvelo \- Plot velocity vectors, crosses, and wedges on maps
.SH SYNOPSIS
.br
\fBpsvelo\fP \fIfiles\fP GMT_J_OPT GMT_Rgeo_OPT [ GMT_B_OPT ] 
[ OPT(D)\fIsigma_scale\fP ] [ OPT(F)\fIcolor\fP ] 
[ OPT(E)\fIcolor\fP ] [ OPT(G)\fIfill\fP ] [ GMT_H_OPT ] [ GMT_K_OPT ] [ OPT(L) ] [ OPT(N) ] 
[ GMT_O_OPT ] [ GMT_P_OPT ] [ OPT(S)\fIsymbol\fP/\fIscale\fP/\fIconf\fP/\fIfont_size\fP ] [ GMT_U_OPT ] 
[ GMT_V_OPT ] [ OPT(W)\fIpen\fP ] [ GMT_X_OPT ] [ GMT_Y_OPT ] [ GMT_t_OPT ] [ GMT_c_OPT ]
.SH DESCRIPTION
.br
\fBpsvelo\fP \fRreads data values from \fIfiles\fP [or standard input]
and generates \fIPostScript\fP code that will plot 
velocity arrows on a map.  Most options are the same as for \fBpsxy\fP,
except OPT(S).  The \fIPostScript\fP code is written to standard
output. The previous version (\fBpsvelomeca\fP) is now obsolete. It has
been replaced by \fBpsvelo\fP and \fBpsmeca\fP.
.br
.sp
.SH ARGUMENTS
\fIfiles\fP
List one or more file-names. If no files are given, \fBpsvelo\fP will read standard input.
#include "explain_-J_short.txt"
#include "explain_-Rgeo.txt"
.br
.sp
OPT(S)Selects the meaning of the columns in the data file and the
figure to be plotted.
.br
.sp
.TP
OPT(Se)\fIvelscale/confidence/fontsize\fP.
Velocity ellipses in
(N,E) convention.  \fIVscale\fP sets the scaling of the velocity arrows.
This scaling gives inches (unless \fBc\fP, \fBi\fP, \fBm\fP, or \fBp\fP is appended).
\fIConfidence\fP sets the 2-dimensional confidence limit for
the ellipse, e.g., 0.95 for 95% confidence ellipse.  \fIFontsize\fP
sets the size of the text in points.  The ellipse will be filled with
the color or shade specified by the OPT(G) option [default
transparent].  The arrow and the circumference of the ellipse will be
drawn with the pen attributes specified by the OPT(W) option.
Parameters are expected to be in the following columns:
.TP
.B 1,2
longitude, latitude of station (OPT(:) option interchanges order)
.TP
.B 3,4
eastward, northward velocity (OPT(:) option interchanges order)
.TP
.B 5,6
uncertainty of eastward, northward velocities (1-sigma) (OPT(:)
option interchanges order)
.TP
.B 7
correlation between eastward and northward components
.TP
.B 8
name of station (optional).
.br
.sp
.TP
OPT(Sn)\fIbarscale.\fP
Anisotropy bars.  \fIBarscale\fP sets the scaling of the bars
This scaling gives inches (unless \fBc\fP, \fBi\fP, \fBm\fP, or \fBp\fP is appended).
Parameters are expected to be in the following columns:
.TP
.B 1,2
longitude, latitude of station (OPT(:) option interchanges order)
.TP
.B 3,4
eastward, northward components of anisotropy vector (OPT(:) option interchanges order)
.br
.br
.sp
.TP
OPT(Sr)\fIvelscale/confidence/fontsize\fP
Velocity ellipses in rotated convention.  \fIVscale\fP sets the scaling of the velocity
arrows. This scaling gives inches (unless \fBc\fP, \fBi\fP, \fBm\fP, or \fBp\fP is appended).
\fIConfidence\fP sets the 2-dimensional confidence limit for
the ellipse, e.g., 0.95 for 95% confidence ellipse.  \fIFontsize\fP
sets the size of the text in points.
The ellipse will be filled with the color or shade specified by the OPT(G) option
[default transparent].  The arrow and the circumference of the ellipse will
be drawn with the pen attributes specified by the OPT(W) option.
Parameters are expected to be in
the following columns:
.TP
.B 1,2
longitude, latitude, of station (OPT(:) option interchanges order)
.TP
.B 3,4
eastward, northward velocity (OPT(:) option interchanges order)
.TP
.B 5,6
semi-major, semi-minor axes
.TP
.B 7
counter-clockwise angle, in degrees, from horizontal axis to major axis of ellipse.
.TP
.B 8
name of station (optional)
.br
.sp
.TP
OPT(Sw)\fIwedge_scale/wedge_mag\fP.
Rotational wedges.
\fIWedge_scale\fP sets the size of the wedges in inches
(unless \fBc\fP, \fBi\fP, \fBm\fP, or \fBp\fP is appended).  Values are
multiplied by \fIWedge_mag\fP before plotting.  For example, setting
\fIWedge_mag\fP to 1.e7 works well for rotations of the order of 100
nanoradians/yr.  Use OPT(G) to set the fill color or shade for the
wedge, and OPT(E) to set the color or shade for the uncertainty.
Parameters are expected to be in the following columns:
.TP
.B 1,2
longitude, latitude, of station (OPT(:) option interchanges order)
.TP
.B 3
rotation in radians
.TP
.B 4
rotation uncertainty in radians
.br
.sp
.TP
OPT(Sx)\fIcross_scale\fP
gives Strain crosses.  \fICross_scale\fP sets the
size of the cross in inches (unless \fBc\fP, \fBi\fP, \fBm\fP, or \fBp\fP 
is appended).  Parameters are expected to be in the
following columns:
.TP
.B 1,2
longitude, latitude, of station (OPT(:) option interchanges order)
.TP
.B 3
eps1, the most extensional eigenvalue of strain tensor, with extension taken positive.
.TP
.B 4
eps2, the most compressional eigenvalue of strain tensor, with extension taken positive.
.TP
.B 5
azimuth of eps2 in degrees CW from North.
.br
.sp
.br
.SH OPTIONS
No space between the option flag and the associated arguments.
.br
.TP
OPT(A)
\fIArrow_width/Head_length/Head_width \fP
Size of arrow in inches.  [Default is 0.03/0.12/0.09].
#include "explain_-B_short.txt"
.TP
OPT(C)
\fROffset focal mechanisms to the latitude and longitude specified in the last
two columns of the input file.
.br
.TP
OPT(D)
\fISigma_scale \fP
can be used to rescale the uncertainties of velocities (OPT(Se) and
OPT(Sr)) and rotations (OPT(Sw)).  Can be combined with the
\fIconfidence \fP variable.
.br
.TP
OPT(F)\fIfill\fP
\fRSets the color or shade used for frame and annotation. [Default is 0/0/0 (black)]
.br
.TP
OPT(E)\fIfill\fP
\fRSets the color or shade used for filling uncertainty wedges (OPT(Sw))
or velocity error ellipses (OPT(Se) or OPT(Sr)).  [If OPT(E) is not
specified, the uncertainty regions will be transparent.]
.br
.TP
OPT(G)\fIfill\fP
\fRSelect filling of ellipses, wedges, and focal mechanisms.  By
convention, the compressional quadrants of the focal mechanism beach
balls are shaded.  Set the shade (0\-255) or color (r/g/b) [Default is
0/0/0].  Optionally, specify OPT(Gp)\fIicon_size/pattern\fP, where
\fIpattern\fP gives the number of the image pattern (1-90) OR the name
of a icon-format file.  \fIicon_size\fP sets the unit size in inches.
To invert black and white pixels, use OPT(GP) instead of
OPT(Gp).  See \fBpspatterns\fP for information on individual
patterns.
#include "explain_-H.txt"
#include "explain_-K.txt"
.TP
OPT(L)
\fRDraw lines.  Ellipses and fault planes will have their outlines drawn using current pen (see OPT(W)).
.br
.TP
OPT(N)
\fRDo \fBNOT\fP skip symbols that fall outside the frame boundary specified by OPT(R).
 [Default plots symbols inside frame only].
#include "explain_-O.txt"
#include "explain_-P.txt"
#include "explain_-U.txt"
#include "explain_-V.txt"
.TP
OPT(W)
\fRSet pen attributes for velocity arrows, ellipse circumference and fault plane edges.
 [Defaults: width = 1, color = 0/0/0, texture = solid].
#include "explain_-XY.txt"
#include "explain_-t.txt"
#include "explain_-c.txt"
.SH EXAMPLES
.sp
The following should make big red arrows with green ellipses, outlined
in red.  Note that the 39% confidence scaling will give an ellipse which
fits inside a rectangle of dimension Esig by Nsig.
.br
.sp
\fBpsvelo\fP << END OPT(H)2 OPT(R)-10/10/-10/10 OPT(W)0.25p,red
OPT(G)green OPT(L) OPT(Se)0.2/0.39/18 OPT(B)1g1 OPT(Jx)0.4/0.4
OPT(A)0.1/0.3/0.3 OPT(P) OPT(V)  >! test.ps
.br
  Long.   Lat.   Evel   Nvel   Esig   Nsig  CorEN SITE
.br
  (deg)  (deg)    (mm/yr)        (mm/yr)
.br
   0.    -8.     0.0    0.0     4.0    6.0  0.500  4x6
.br
  -8.     5.     3.0    3.0     0.0    0.0  0.500  3x3
.br
   0.     0.     4.0    6.0     4.0    6.0  0.500
.br
  -5.    -5.     6.0    4.0     6.0    4.0  0.500  6x4
.br
   5.     0.    -6.0    4.0     6.0    4.0 -0.500  -6x4
.br
   0.    -5.     6.0   -4.0     6.0    4.0 -0.500  6x-4
.br
END
.br
This example should plot some residual rates of rotation in the
Western Transverse Ranges, California.  The wedges will be
dark gray, with light gray wedges to represent the 2-sigma
uncertainties.
.br
.sp
\fBpsvelo\fP <<END OPT(Sw)0.4/1.e7 OPT(W)0.75p OPT(G)darkgray OPT(E)lightgray OPT(H)1 OPT(D)2
OPT(Jm)2.2 OPT(R)240./243./32.5/34.75 OPT(B)f10ma60m/WeSn OPT(P) >! test.ps
.br
 lon     lat    spin(rad/yr) spin_sigma (rad/yr)
.br
241.4806 34.2073  5.65E-08 1.17E-08
.br
241.6024 34.4468 -4.85E-08 1.85E-08
.br
241.0952 34.4079  4.46E-09 3.07E-08
.br
241.2542 34.2581  1.28E-07 1.59E-08
.br
242.0593 34.0773 -6.62E-08 1.74E-08
.br
241.0553 34.5369 -2.38E-07 4.27E-08
.br
241.1993 33.1894 -2.99E-10 7.64E-09
.br
241.1084 34.2565  2.17E-08 3.53E-08
.br
END
.br
.sp
.SH "SEE ALSO"
.IR GMT (1),
.IR psbasemap (1),
.IR psxy (1)
.SH REFERENCES
.br
\fRBomford, G., Geodesy, 4th ed., Oxford University Press, 1980.
.SH AUTHORS
Kurt Feigl
.br
CNRS UMR 5562
.br
Toulouse, France
.br
(Kurt.Feigl@.cnes.fr)
.br
.br
Genevieve Patau
.br
CNRS UMR 7580
.br
Seismology Dept.
.br
Institut de Physique du Globe de Paris
.br
(patau@ipgp.jussieu.fr)
