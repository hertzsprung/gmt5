.TH PSWIGGLE GMTMANSECTION DATE VERSION VERSION
#define LEN 15
#define SCALE_S \fB\-JS\fP0/90/15\fBc\fP
.SH NAME
pswiggle \- Plot anomaly along track on a map
.SH SYNOPSIS
\fBpswiggle\fP \fIxyz_files\fP \fB\-J\fP\fIparameters\fP \fB\-R\fP\fIwest/east/south/north\fP[\fBr\fP] 
\fB\-Z\fP\fIscale\fP [ \fB\-A\fP\fIazimuth\fP ] [ \fB\-B\fP\fItickinfo\fP ] [ \fB\-C\fP\fIcenter\fP ] [ \fB\-D\fP\fIgap\fP ] [ \fB\-E\fP\fIazimuth/elevation\fP ] 
[ \fB\-G\fP\fIfillrgb\fP ] [ \fB\-H\fP[\fInrec\fP] ] 
[ \fB\-I\fP\fIfix_az\fP ] [ \fB\-K\fP ] [ \fB\-M\fP[\fIflag\fP] ] [ \fB\-N\fP ] [ \fB\-O\fP ] [ \fB\-P\fP ] 
[ \fB\-S\fP[\fBx\fP]\fIlon0/lat0/length\fP[\fIunits\fP] ] [ \fB\-T\fP\fItrack_pen\fP ] 
[ \fB\-U\fP[\fI/dx/dy/\fP][\fIlabel\fP] ] [ \fB\-V \fP ] [ \fB\-W\fP\fIwiggle_pen\fP ] [ \fB\-X\fP\fIx-shift\fP ] 
[ \fB\-Y\fP\fIy-shift\fP ] [ \fB\-c\fP\fIcopies\fP ] [ \fB\-:\fP ] [ \fB\-bi\fP[\fBs\fP][\fIn\fP] ] [ \fB\-f\fP[\fBi|o\fP]\fP\fIcolinfo\fP ]
.SH DESCRIPTION
\fBpswiggle\fP reads (x,y,z) triplets from files [or standard input] and plots z as a function of
distance along track.  This means that two consecutive (x,y) points define the local distance axis,
and the local z axis is then perpendicular to the distance axis.  The user may set a preferred
positive anomaly plot direction, and if the positive normal is outside
the plus/minus 90 degree window around the preferred direction, then 180 degrees are added to the
direction.  Either the positive or the negative wiggle may be shaded.  The resulting \fIPostScript\fP
code is written to standard output.
.TP
\fIfiles\fP
List one or more file-names. If no files are given, \fBpswiggle\fP will read standard input.
#include "explain_-J_short.txt"
#include "explain_-R.txt"
.TP
.B \-Z
Gives anomaly scale in data-units/distance-unit.
.SH OPTIONS
No space between the option flag and the associated arguments.
.TP
.B \-A
Sets the preferred positive azimuth.  Positive wiggles will "gravitate" towards that
direction.
#include "explain_-B_short.txt"
.TP
.B \-C
Subtract \fIcenter\fP from the data set before plotting [0].
.TP
.B \-D
Means there is a data gap if 2 consecutive points are more than \fIgap\fP distance
units apart.  For longitude/latitude data \fIgap\fP is in km, else it is in the
user's units.
.TP
.B \-E
Sets the viewpoint's azimuth and elevation [180/90].
.TP
.B \-G
Set fill of positive wiggles. [Default is black]
#include "explain_-G.txt"
#include "explain_-H.txt"
.TP
.B \-I
Set a fixed azimuth projection for wiggles [Default uses track azimuth, but see \fB\-A\fP].
#include "explain_-K.txt"
.TP
.B \-M
Multiple segment file.  Segments are separated by a record whose first character is \fIflag\fP.
[Default is '>'].
.TP
.B \-N
Paint negative wiggles instead of positive [Default].
#include "explain_-O.txt"
#include "explain_-P.txt"
.TP
.B \-S
Draws a simple vertical scale centered on \fIlon0/lat0\fP.  Use \fB\-Sx\fP to specify cartesian coordinates instead.
\fIlength\fP is in z units, append unit name for labeling
.TP
.B \-T
Draw track  [Default is no track].  Append pen attributes to use [Defaults: width = 1, color = 0/0/0, texture = solid].
#include "explain_-U.txt"
#include "explain_-V.txt"
.TP
.B \-W
Draw wiggle outline  [Default is no outline].  Append pen attributes to use
[Defaults: width = 1, color = 0/0/0, texture = solid].
#include "explain_-XY.txt"
#include "explain_-t.txt"
#include "explain_-i_binary.txt"
#include "explain_-n.txt"
[Default is 3 input columns].
#include "explain_-c.txt"
#include "explain_-f.txt"
.SH EXAMPLES
To plot the magnetic anomaly stored in the file track.xym along track @ 1000 nTesla/cm (after removing a mean value of 32000 Tesla),
using a LEN-cm-wide Polar Stereographic map ticked
every 5 degrees in Portrait mode, with positive anomalies in red on a blue track of width 0.25 points, use
.br
.sp
\fBpswiggle\fP track.xym \fB\-R\fP-20/10/-80/-60 SCALE_S \fB\-Z\fP1000 \fB\-B\fP5 \fB\-P \-G\fP255/0/0 \fB\-T\fP0.25\fBp\fP/0/0/255 \fB\-S\fP1000 \fB\-V\fP > track_xym.ps
.SH BUGS
Sometimes the (x,y) coordinates are not printed with enough significant
digits, so the local perpendicular to the track swings around a lot.  To
see if this is the problem, you should do this:
.br
.sp
awk '{ if (NR > 1) print atan2(y-$1, x-$2); y=$1; x=$2; }' yourdata.xyz | more
.br
.sp
(note that output is in radians; on some machines you need "nawk" to do this).
Then if these numbers jump around a lot, you may do this:
.br
.sp
\fBgmtset\fP D_FORMAT %.12lg
.br
awk '{ print NR, $0 }' yourdata.xyz | \fBfilter1d\fP \fB\-Fb\fP5 \fB\-N\fP4/0 > smoothed.xyz
.br
.sp
and plot this data set instead.
.SH "SEE ALSO"
.IR gmt (GMTMANSECTION),
.IR filter1d (GMTMANSECTION),
.IR psbasemap (GMTMANSECTION),
.IR splitxyz (GMTMANSECTION)
