#include "common_options.txt"
.TH SPECTRUM1D 1 MANDATE GMT_STRING "Generic Mapping Tools"
.SH NAME
spectrum1d \- Compute auto\- [and cross\- ] spectra from one [or two] time-series
.SH SYNOPSIS
BD(spectrum1d) [ IT(table) ] OPT(S)IT(segment_size)] 
[ OPT(C)[BD(xycnpago)] ] [ OPT(D)IT(dt) ] [ OPT(L)[BD(h)|BD(m)] ] 
[ OPT(N)[BD(+)]IT(name_stem) ] [ GMT_V_OPT ] [ OPT(W) ] 
[ GMT_b_OPT ] [ GMT_f_OPT ] [ GMT_g_OPT ] [ GMT_h_OPT ] [ GMT_i_OPT ]
.SH DESCRIPTION
BD(spectrum1d) reads X [and Y] values from the first [and second] columns on standard input 
[or IT(x[y]file)].  These values are treated as timeseries X(t) [Y(t)] sampled at equal intervals 
spaced IT(dt) units apart.  There may be any number of lines of input.  BD(spectrum1d) will create 
file[s] containing auto\- [and cross\- ] spectral density estimates by Welch's method of ensemble\"'
averaging of multiple overlapped windows, using standard error estimates from Bendat and Piersol.
.sp
The output files have 3 columns: f or w, p, and e.  f or w is the frequency or wavelength, p is the 
spectral density estimate, and e is the one standard deviation error bar size.  These files are named 
based on IT(name_stem).  If the OPT(C) option is used, up to eight files are created; otherwise only one 
(xpower) is written.  The files (which are ASCII unless GMT_bo_OPT is set) are as follows:
.TP
IT(name_stem).xpower
Power spectral density of X(t).  Units of X * X * IT(dt).
.TP
IT(name_stem).ypower
Power spectral density of Y(t).  Units of Y * Y * IT(dt).
.TP
IT(name_stem).cpower
Power spectral density of the coherent output.  Units same as ypower.
.TP
IT(name_stem).npower
Power spectral density of the noise output.  Units same as ypower.
.TP
IT(name_stem).gain
Gain spectrum, or modulus of the transfer function.  Units of (Y / X).
.TP
IT(name_stem).phase
Phase spectrum, or phase of the transfer function.  Units are radians.
.TP
IT(name_stem).admit
Admittance spectrum, or real part of the transfer function.  Units of (Y / X).
.TP
IT(name_stem).coh
(Squared) coherency spectrum, or linear correlation coefficient as a function of frequency.  
Dimensionless number in [0, 1].  The Signal-to-Noise-Ratio (SNR) is coh / (1 - coh).  SNR = 1 when coh = 0.5.
#include "explain_commonitems.txt"
.SH REQUIRED ARGUMENTS
.TP
OPT(S)IT(segment_size)]
IT(segment_size) is a radix-2 number of samples per window for ensemble averaging.  The smallest frequency 
estimated is 1.0/(IT(segment_size) * IT(dt)), while the largest is 1.0/(2 * IT(dt)).  One standard error 
in power spectral density is approximately 1.0 / sqrt(IT(n_data) / IT(segment_size)), so if IT(segment_size) 
= 256, you need 25,600 data to get a one standard error bar of 10%.  Cross-spectral error bars are larger and more 
complicated, being a function also of the coherency. 
.SH OPTIONAL ARGUMENTS
.TP
IT(table)
One or more ASCII (or binary, see GMT_bi_OPT) files holding X(t) [Y(t)] samples in the first 1 [or 2] columns.
If no files are specified, BD(spectrum1d) will read from standard input.
.TP
OPT(C)[BD(xycnpago)]
Read the first two columns of input as samples of two time-series, X(t) and Y(t).
Consider Y(t) to be the output and X(t) the input in a linear system with noise.
Estimate the optimum frequency response function by least squares, such that the
noise output is minimized and the coherent output and the noise output are
uncorrelated.
Optionally specify up to 8 letters from the set { BD(x y c n p a g o) }
in any order to create only those output files instead of the default [all].
BD(x) = xpower, BD(y) = ypower, BD(c) = cpower, BD(n) = npower,
BD(p) = phase, BD(a) = admit, BD(g) = gain, BD(o) = coh.
.TP
OPT(D)IT(dt)
IT(dt)  Set the spacing between samples in the time-series [Default = 1].
.TP
OPT(L)
Leave trend alone.  By default, a linear trend will be removed prior to the transform.
Alternatively, append BD(m) to just remove the mean value or BD(h) to remove the mid-value.
.TP
OPT(N)[BD(+)]IT(name_stem)
IT(name_stem)  Supply the name stem to be used for output files [Default = "spectrum"].
To place all the computed output columns in a single table, use OPT(N+).
#include "explain_-V.txt"
.TP
OPT(W)
Write Wavelength rather than frequency in column 1 of the output file[s] [Default = frequency, (cycles / IT(dt))].
#include "explain_-bi.txt"
[Default is 2 input columns].
#include "explain_-bo.txt"
[Default is 2 output columns].
#include "explain_-f.txt"
#include "explain_-g.txt"
#include "explain_-h.txt"
#include "explain_-icols.txt"
#include "explain_help.txt"
#include "explain_precision.txt"
.SH EXAMPLES
Suppose data.g is gravity data in mGal, sampled every 1.5 km.  To write its power spectrum, in mGal**2-km, 
to the file data.xpower, use  
.sp
    spectrum1d data.g -S256 -D1.5 -Ndata
.sp
Suppose in addition to data.g you have data.t, which is topography in meters sampled at the same points as 
data.g.  To estimate various features of the transfer function, considering data.t as input and data.g as 
output, use
.sp
    paste data.t data.g | spectrum1d -S256 -D1.5 -Ndata -C
.SH "SEE ALSO"
.IR gmt (1),
.IR grdfft (1)
.SH REFERENCES
Bendat, J. S., and A. G. Piersol, 1986, Random Data, 2nd revised ed., John Wiley & Sons.
.sp
Welch, P. D., 1967, The use of Fast Fourier Transform for the estimation of power spectra:  a method 
based on time averaging over short, modified periodograms, IEEE Transactions on Audio and Electroacoustics, 
Vol AU-15, No 2.
