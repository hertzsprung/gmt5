#include "common_options.txt"
.TH GRDVIEW 1 MANDATE GMT_STRING "Generic Mapping Tools"
#define LEN_1	1.5
#define LEN_2	20
#define LEN_3	6
#define SCALE1	OPT(Jl)18/24/1.5BD(c)
#define ZSCALE1	OPT(Jz)0.05BD(c)
#define SCALE2	OPT(Jx)10.0BD(c)
#define SCALE3 OPT(JM)6BD(i)
.SH NAME
grdview \- Create 3-D perspective image or surface mesh from a grid
.SH SYNOPSIS
BD(grdview) IT(relief_file) GMT_J_OPT 
[ GMT_B_OPT ] [ OPT(C)IT(cptfile)]
[ OPT(G)IT(drapefile) | OPT(G)IT(grd_r),IT(grd_g),IT(grd_b) ] [ OPT(I)IT(intensfile) ] 
[ GMT_Jz_OPT ] [ GMT_K_OPT ] [ OPT(L)[IT(flags)] ] [ OPT(N)IT(level)[/IT(color)] ] 
[ GMT_O_OPT ] [ GMT_P_OPT ] [ OPT(Q)IT(type)[BD(g)] ] [ GMT_Rgeoz_OPT ] [ OPT(S)IT(smooth) ] 
[ OPT(T)[BD(s)][BD(o)[IT(pen)]] ] [ GMT_U_OPT ] [ GMT_V_OPT ] [ OPT(W)BD(type)IT(pen) ] 
[ GMT_X_OPT ] [ GMT_Y_OPT ] [ GMT_c_OPT ] [ GMT_n_OPT ] [ GMT_p_OPT ] [ GMT_t_OPT ]
.SH DESCRIPTION
BD(grdview) reads a 2-D grid file and produces a 3-D perspective plot by 
drawing a mesh, painting a colored/grayshaded surface made up of polygons, or by scanline conversion of these polygons
to a raster image.  Options include draping a data set on top of a surface, plotting of contours on top of the
surface, and apply artificial illumination based on intensities provided in a separate grid file.
#include "explain_commonitems.txt"
.SH REQUIRED ARGUMENTS
.TP
IT(relief_file)
2-D gridded data set to be imaged (the relief of the surface).
(See GRID FILE FORMAT below.)
#include "explain_-J.txt"
#include "explain_-Jz.txt"
.SH OPTIONAL ARGUMENTS
#include "explain_-B.txt"
.TP
OPT(C)IT(cptfile)
name of the color palette file.  Must be present if you want (1) mesh plot with
contours (OPT(Qm)), or (2) shaded/colored perspective image (OPT(Qs) or OPT(Qi)).
For OPT(Qs): You can specify that you want to skip a z-slice by setting red = -; to
use a pattern give red = BD(P|p)IT(dpi/pattern)[:BD(F)IT(color)[BD(B)IT(color)]].
.TP
OPT(G)IT(drapefile) | OPT(G)IT(grd_r),IT(grd_g),IT(grd_b)
Drape the image in IT(drapefile) on top of the relief provided by IT(relief_file). [Default is IT(relief_file)].
Note that OPT(Jz) and OPT(N) always refers to the IT(relief_file).  The IT(drapefile) only provides
the information pertaining to colors, which is looked-up via the cpt file (see OPT(C)).  Alternatively, give
three grid files separated by commas.  These files must contain the red, green, and blue colors directly (in 0-255 range)
and no cpt file is needed.  The IT(drapefile) may be of higher resolution than the IT(relief_file).
.TP
OPT(I)IT(intensfile)
Gives the name of a grid file with intensities in the (-1,+1) range. [Default is no illumination].
#include "explain_-K.txt"
.TP
OPT(L)[IT(flags)]
Boundary condition IT(flags) may be IT(x) or IT(y) or IT(xy) indicating data is periodic in range of
x or y or both, or IT(flags) may be IT(g) indicating geographical conditions (x and y are
lon and lat).  [Default uses "natural" conditions (second partial derivative normal to edge is zero).]
If no IT(flags) are set, use bilinear rather than the default bicubic resampling when draping is required.
.TP
OPT(N)IT(level)[/IT(color)]
Draws a plane at this z-level.  If the optional IT(color) is provided, the frontal facade between
the plane and the data perimeter is colored.  See OPT(Wf) for setting the pen used for the outline.
#include "explain_-O.txt"
#include "explain_-P.txt"
.TP
OPT(Q)IT(type)[BD(g)]
Select one of four settings: 1. Specify BD(m) for mesh plot [Default], and optionally append /IT(color) for a different mesh paint [white].
2. Specify BD(s) for surface plot, and optionally append BD(m) to have mesh lines drawn on top of surface.
3. Specify BD(i) for image plot, and optionally append the effective dpi resolution for the rasterization [100].
4. Specify BD(c).  Same as OPT(Qi) but will make nodes with z = NaN transparent,
using the colormasking feature in IT(PostScript) Level 3 (the PS device must support PS Level 3).
For any of these choices, you may force a monochrome image by appending BD(g).  Colors are then
converted to shades of gray using the (television) YIQ transformation.
#include "explain_-R.txt"
#include "explain_-Rz.txt"
This option may be used to indicate the range used for the 3-D axes [Default is
region given by the IT(relief_file)].  You may ask for a larger
IT(w/e/s/n) region to have more room between the image and the axes.  A smaller region
than specified in the IT(relief_file) will result in a subset of the grid.
.TP
OPT(S)IT(smooth)
Smooth the contours before plotting (see BD(grdcontour)) [Default is no smoothing].
.TP
OPT(T)[BD(s)][BD(o)[IT(pen)]]
Plot image without any interpolation.  This involves converting each node-centered
bin into a polygon which is then painted separately.  Append BD(s) to skip
nodes with z = NaN.  This option is useful for categorical data where
interpolating between values is meaningless.  Optionally, append BD(o) to
draw the tile outlines, and specify a custom pen if the default pen is not to
your liking.  As this option produces a flat surface it cannot be combined with OPT(JZ) or OPT(Jz).
#include "explain_-U.txt"
#include "explain_-V.txt"
.TP
OPT(W)BD(type)IT(pen)
.TP
OPT(Wc)
Draw contour lines on top of surface or mesh (not image).  Append pen attributes used for the contours.
[Default: width = 0.75p, color = black, style = solid].
.TP
OPT(Wm)
Sets the pen attributes used for the mesh. [Default: width = 0.25p, color = black, style = solid].
You must also select OPT(Qm) or OPT(Qsm) for meshlines to be drawn.
.TP
OPT(Wf)
Sets the pen attributes used for the facade. [Default: width = 0.25p, color = black, style = solid].
You must also select OPT(N) for the facade outline to be drawn.
#include "explain_-XY.txt"
#include "explain_-c.txt"
#include "explain_-n.txt"
#include "explain_perspective.txt"
#include "explain_-t.txt"
#include "explain_help.txt"
#include "explain_grd_input.txt"
.SH EXAMPLES
To make a mesh plot from the file hawaii_grav.nc and drawing the contours
given in the color palette file hawaii.cpt on a Lambert map
at LEN_1 cm/degree along the standard parallels 18 and 24, with vertical scale LEN_2 mgal/cm, and
looking at the surface from SW at 30 degree elevation, run 
.br
.sp
grdview hawaii_grav.nc SCALE1 -Chawaii.cpt ZSCALE1 -Qm -N-100 -p225/30 -Wc > hawaii_grav_image.ps
.br
.sp
To create a illuminated color perspective plot of the gridded data set image.nc, using the color
palette file color.rgb, with linear scaling at 10 cm/x-unit
and tickmarks every 5 units, with intensities provided by the file intens.nc, and looking from the SE, use
.br
.sp
grdview image.nc SCALE2 -Ccolor.rgb -Qs -p135/30 -Iintens.nc  > image3D.ps
.br
.sp
To make the same plot using the rastering option with dpi = 50, use
.br
.sp
grdview image.nc SCALE2 -Ccolor.rgb -Qi50 -p135/30 -Iintens.nc  > image3D.ps
.br
.sp
To create a color IT(PostScript) perspective plot of the gridded data set magnetics.nc, using the color
palette file mag_intens.cpt, draped over the relief given by the file topography.nc, with Mercator map width of LEN_3 inch
and tickmarks every 1 degree, with intensities provided by the file topo_intens.nc, and looking from the SE, run
.br
.sp
grdview topography.nc SCALE3 -Gmagnetics.nc -Cmag_intens.cpt -Qs -p140/30 -Itopo_intens.nc  > draped3D.ps
.br
.sp
Given topo.nc and the Landsat image veggies.ras, first run BD(grd2rgb) to get the red, green, and blue grids, and then drape
this image over the topography and shade the result for good measure.  The commands are
.br
.sp
grd2rgb veggies.ras -Glayer_%c.nc
.br
grdview topo.nc SCALE3 -Qi -p140/30 -Itopo_intens.nc -Glayer_r.nc,layer_g.nc,layer_b.nc > image.ps
.SH REMARKS
For the OPT(Qs) option:  IT(PostScript) provides no way of smoothly varying colors within a polygon, so colors can only
vary from polygon to polygon.  To obtain smooth images this way you may resample the grid file(s) using BD(grdsample) or
use a finer grid size when running gridding programs like BD(surface) or BD(nearneighbor).  Unfortunately,
this produces huge IT(PostScript) files.  The alternative is to use the OPT(Qi) option, which
computes bilinear or bicubic continuous color variations within polygons by using scanline conversion to image the polygons.
.SH "SEE ALSO"
.IR gmt (1),
.IR grd2rgb (1),
.IR gmtcolors (5),
.IR grdcontour (1),
.IR grdimage (1),
.IR nearneighbor (1),
.IR psbasemap (1),
.IR pscontour (1),
.IR pstext (1),
.IR surface (1)
