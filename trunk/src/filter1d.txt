#include "common_options.txt"
.TH FILTER1D 1 MANDATE GMT_STRING "Generic Mapping Tools"
.SH NAME
filter1d \- Time domain filtering of 1-D time series
.SH SYNOPSIS
BD(filter1d) [ IT(infile) ] OPT(F)IT(type<width>)[IT(mode)] [ OPT(D)IT(increment) ]  
[ OPT(E) ] [ OPT(I)IT(ignore_val) ] [ OPT(L)IT(lack_width) ] 
[ OPT(N)IT(t_col) ] [ OPT(Q)IT(q_factor) ] [ OPT(S)IT(symmetry_factor) ] 
[ OPT(T)IT(start/stop/int) ] [ GMT_V_OPT ] [ GMT_b_OPT ] [ GMT_f_OPT ] [ GMT_g_OPT ] [ GMT_h_OPT ] [ GMT_i_OPT ] [ GMT_o_OPT ]
.SH DESCRIPTION
BD(filter1d) is a general time domain filter for multiple column time series data.
The user specifies which column is the time (i.e., the independent variable).
(See OPT(N) option below).  The fastest operation occurs when the input time series are
equally spaced and have no gaps or outliers and the special options are not needed.
BD(filter1d) has options OPT(L), OPT(Q), and OPT(S) for unevenly sampled data with gaps.
#include "explain_commonitems.txt"
.SH REQUIRED ARGUMENTS
.TP
OPT(F)IT(type<width>)[IT(mode)]
Sets the filter IT(type).  Choose among convolution and non-convolution filters.  Append the filter code followed
by the full filter IT(<width>) in same units as time column. Available convolution filters are:
.br
(BD(b)) Boxcar: All weights are equal.
.br
(BD(c)) Cosine Arch: Weights follow a cosine arch curve.
.br
(BD(g)) Gaussian: Weights are given by the Gaussian function.
.br
(BD(f)) Custom: Instead of IT(width) give name of a one-column file with your own weight coefficients.
.br
Non-convolution filters are:
.br
(BD(m)) Median: Returns median value.
.br
(BD(p)) Maximum likelihood probability (a mode estimator): Return modal value.
If more than one mode is found we return their average value.  Append - or + to
the filter width if you rather want to return the smallest or largest of the modal
values.
.br
(BD(l)) Lower: Return the minimum of all values.
.br
(BD(L)) Lower: Return minimum of all positive values only.
.br
(BD(u)) Upper: Return maximum of all values.
.br
(BD(U)) Upper: Return maximum or all negative values only.
.br
Upper case type BD(B), BD(C), BD(G), BD(M), BD(P), BD(F) will use robust filter versions:
i.e., replace outliers (2.5 L1 scale off median) with median during filtering.
.br
In the case of BD(L)|BD(U) it is possible that no data passes the initial sign test; in that case
the filter will return 0.0.
.SH OPTIONAL ARGUMENTS
.TP
IT(infile)
Multi-column ASCII (or binary, see GMT_bi_OPT) file holding data values to be filtered.  If no file
is given then we read from standard input.
.TP
OPT(D)IT(increment)
IT(increment) is used when series is NOT equidistantly sampled.
Then IT(increment) will be the abscissae resolution, i.e., all abscissae
will be rounded off to a multiple of IT(increment).  Alternatively, resample
data with BD(sample1d).
.TP
OPT(E)
Include Ends of time series in output.  Default loses half the filter-width of data at each end.
.TP
OPT(I)IT(ignore_val)
To ignore values; If an input value equals IT(ignore_val) it will be set to NaN.
.TP
OPT(L)IT(lack_width)
Checks for Lack of data condition.  If input data has a gap exceeding
IT(width) then no output will be given at that point [Default does not check Lack].
.TP
OPT(N)IT(t_col)
Indicates which column contains the independent
variable (time). The left-most column is # 0, the right-most is # (IT(n_cols) - 1).
[Default is 0].
.TP
OPT(Q)IT(q_factor)
assess Quality of output value by checking mean weight in convolution.
Enter IT(q_factor) between 0 and 1.  If mean weight < IT(q_factor), output is suppressed
at this point [Default does not check Quality].
.TP
OPT(S)IT(symmetry_factor)
Checks symmetry of data about window center.  Enter a factor
between 0 and 1.  If ( (abs(n_left - n_right)) / (n_left + n_right) ) > IT(factor),
then no output will be given at this point [Default does not check Symmetry].
.TP
OPT(T)IT(start/stop/int)
Make evenly spaced time-steps from IT(start) to IT(stop) by IT(int) [Default uses input times].
#include "explain_-V.txt"
#include "explain_-bi.txt"
#include "explain_-bo.txt"
[Default is same as input].
#include "explain_-f.txt"
#include "explain_-g.txt"
#include "explain_-h.txt"
#include "explain_-icols.txt"
#include "explain_-ocols.txt"
#include "explain_help.txt"
#include "explain_precision.txt"
.SH EXAMPLES
To filter the data set in the file cruise.gmtd containing evenly spaced gravity, magnetics, topography,
and distance (in m) with a 10 km Gaussian filter, removing outliers, and output a filtered
value every 2 km between 0 and 100 km:
.br
.sp
filter1d cruise.gmtd -T0/1.0e5/2000 -FG10000 -N3 -V > filtered_cruise.gmtd
.br
.sp
Data along track often have uneven sampling and gaps which we do not want to interpolate using BD(sample1d).
To find the median depth in a 50 km window every 25 km along the track of cruise v3312, stored in v3312.dt,
checking for gaps of 10km and asymmetry of 0.3:
.br
.sp
filter1d v3312.dt -FM50 -T0/100000/25 -L10 -S0.3 > v3312_filt.dt
.SH "SEE ALSO"
.IR gmt (1),
.IR sample1d (1)
